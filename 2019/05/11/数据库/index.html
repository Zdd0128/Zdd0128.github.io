<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="MySQL数据库环境配置及服务制作(安装:参考网站：https:&#x2F;&#x2F;www.mysql.com&#x2F;) 1234567891011121314151617# 1.每次启动mysql需要先切到对应的文件夹路径下才能操作太多繁琐将mysql所在的文件夹路径添加到系统环境变量中# 2.将mysql制作成系统服务	   mysql--install# 3.移除mysql系统服务	   mysql --remo">
<meta property="og:type" content="article">
<meta property="og:title" content="MySql数据库">
<meta property="og:url" content="http://example.com/2019/05/11/%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="左大大的博客">
<meta property="og:description" content="MySQL数据库环境配置及服务制作(安装:参考网站：https:&#x2F;&#x2F;www.mysql.com&#x2F;) 1234567891011121314151617# 1.每次启动mysql需要先切到对应的文件夹路径下才能操作太多繁琐将mysql所在的文件夹路径添加到系统环境变量中# 2.将mysql制作成系统服务	   mysql--install# 3.移除mysql系统服务	   mysql --remo">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-05-10T23:20:25.000Z">
<meta property="article:modified_time" content="2019-06-01T04:22:34.000Z">
<meta property="article:author" content="左大大">
<meta property="article:tag" content="Python Linux Vue">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2019/05/11/%E6%95%B0%E6%8D%AE%E5%BA%93/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2019/05/11/%E6%95%B0%E6%8D%AE%E5%BA%93/","path":"2019/05/11/数据库/","title":"MySql数据库"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySql数据库 | 左大大的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">左大大的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.</span> <span class="nav-text">MySQL数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%8F%8A%E6%9C%8D%E5%8A%A1%E5%88%B6%E4%BD%9C"><span class="nav-number">1.0.1.</span> <span class="nav-text">环境配置及服务制作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql%E8%AF%AD%E5%8F%A5%E5%88%9D%E8%AF%86"><span class="nav-number">1.0.2.</span> <span class="nav-text">sql语句初识</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%86%E7%A0%81%E7%9B%B8%E5%85%B3"><span class="nav-number">1.0.3.</span> <span class="nav-text">密码相关</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80-%E5%9F%BA%E6%9C%ACsql%E8%AF%AD%E5%8F%A5%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.</span> <span class="nav-text">一.基本sql语句介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E9%92%88%E5%AF%B9%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5-%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">1.针对库的增删改查(文件夹)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E9%92%88%E5%AF%B9%E8%A1%A8%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5-%E6%96%87%E4%BB%B6"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">2.针对表的增删改查(文件)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E9%92%88%E5%AF%B9%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5-%E8%AE%B0%E5%BD%95"><span class="nav-number">1.1.0.3.</span> <span class="nav-text">3.针对数据的增删改查(记录)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%9A%84%E5%AE%8C%E6%95%B4%E8%AF%AD%E6%B3%95"><span class="nav-number">1.1.0.4.</span> <span class="nav-text">4.创建表的完整语法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">1.2.</span> <span class="nav-text">二.存储引擎</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89-MySQL%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">三.MySQL基本数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.3.0.1.</span> <span class="nav-text">设置严格模式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B-%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6-%E6%8E%8C%E6%8F%A1"><span class="nav-number">1.4.</span> <span class="nav-text">四.约束条件(掌握)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E4%B8%BB%E9%94%AE%E7%9A%84%E7%89%B9%E5%BE%81"><span class="nav-number">1.4.0.1.</span> <span class="nav-text">1.主键的特征</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E5%A4%96%E9%94%AE"><span class="nav-number">1.4.0.2.</span> <span class="nav-text">2.外键</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E7%BA%A7%E8%81%94%E6%9B%B4%E6%96%B0-%E7%BA%A7%E8%81%94%E5%88%A0%E9%99%A4"><span class="nav-number">1.4.0.3.</span> <span class="nav-text">3.级联更新  级联删除</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="nav-number">1.4.0.4.</span> <span class="nav-text">4.表关系</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">1.5.</span> <span class="nav-text">五.查询关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%89%8D%E6%9C%9F%E8%A1%A8%E5%87%86%E5%A4%87"><span class="nav-number">1.5.0.1.</span> <span class="nav-text">前期表准备</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Bwhere-%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE"><span class="nav-number">1.5.0.2.</span> <span class="nav-text">1.查询关键字之where(筛选数据)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Bgroup-by-%E5%88%86%E7%BB%84"><span class="nav-number">1.5.0.3.</span> <span class="nav-text">2.查询关键字之group by(分组)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Bhaving-%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE"><span class="nav-number">1.5.0.4.</span> <span class="nav-text">3.查询关键字之having(筛选数据)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Bdistinct-%E5%8E%BB%E9%87%8D"><span class="nav-number">1.5.0.5.</span> <span class="nav-text">4.查询关键字之distinct(去重)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Border-by-%E6%8E%92%E5%BA%8F"><span class="nav-number">1.5.0.6.</span> <span class="nav-text">5.查询关键字之order by(排序)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Blimit-%E5%88%86%E9%A1%B5"><span class="nav-number">1.5.0.7.</span> <span class="nav-text">6.查询关键字之limit(分页)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-%E6%9F%A5%E8%AF%A2%E5%85%B3%E9%94%AE%E5%AD%97%E4%B9%8Bregexp-%E6%AD%A3%E5%88%99"><span class="nav-number">1.5.0.8.</span> <span class="nav-text">7.查询关键字之regexp(正则)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.6.</span> <span class="nav-text">六.多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E6%80%9D%E6%83%B3"><span class="nav-number">1.6.0.1.</span> <span class="nav-text">多表查询思想</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%89%8D%E6%9C%9F%E8%A1%A8%E5%87%86%E5%A4%87-1"><span class="nav-number">1.6.0.2.</span> <span class="nav-text">前期表准备</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.6.1.</span> <span class="nav-text">1.子查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%BF%9E%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.6.2.</span> <span class="nav-text">2.连表操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-Navicat%E5%8F%AF%E8%A7%86%E5%8C%96%E8%BD%AF%E4%BB%B6"><span class="nav-number">1.6.3.</span> <span class="nav-text">3.Navicat可视化软件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E8%A1%A8%E5%AD%97%E6%AE%B5%E6%93%8D%E4%BD%9C%E8%A1%A5%E5%85%85"><span class="nav-number">1.6.4.</span> <span class="nav-text">4.表字段操作补充</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83-python%E6%93%8D%E4%BD%9CMySQL"><span class="nav-number">1.7.</span> <span class="nav-text">七.python操作MySQL</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="nav-number">1.7.0.1.</span> <span class="nav-text">SQL注入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="nav-number">1.7.0.2.</span> <span class="nav-text">其他操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB-%E5%85%B6%E4%BB%96%E7%9B%B8%E5%85%B3"><span class="nav-number">1.8.</span> <span class="nav-text">八.其他相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E8%A7%86%E5%9B%BE"><span class="nav-number">1.8.1.</span> <span class="nav-text">1.视图</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%BA%E8%B0%83"><span class="nav-number">1.8.1.1.</span> <span class="nav-text">强调</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">1.8.2.</span> <span class="nav-text">2.触发器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BA%8B%E5%8A%A1"><span class="nav-number">1.8.3.</span> <span class="nav-text">3.事务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">1.8.4.</span> <span class="nav-text">4.存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.8.4.1.</span> <span class="nav-text">1.基本使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E4%B8%89%E7%A7%8D%E5%BC%80%E5%8F%91%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.8.4.2.</span> <span class="nav-text">2.三种开发模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">1.8.4.3.</span> <span class="nav-text">3.创建存储过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">1.8.4.4.</span> <span class="nav-text">4.如何使用存储过程</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E5%87%BD%E6%95%B0"><span class="nav-number">1.8.5.</span> <span class="nav-text">5.函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-number">1.8.6.</span> <span class="nav-text">6.流程控制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-%E7%B4%A2%E5%BC%95"><span class="nav-number">1.8.7.</span> <span class="nav-text">7.索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#b-%E6%A0%91"><span class="nav-number">1.8.7.1.</span> <span class="nav-text">b+树</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95-primary-key"><span class="nav-number">1.8.7.2.</span> <span class="nav-text">聚集索引(primary key)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BE%85%E5%8A%A9%E7%B4%A2%E5%BC%95-unique-index"><span class="nav-number">1.8.7.3.</span> <span class="nav-text">辅助索引(unique,index)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E7%B4%A2%E5%BC%95"><span class="nav-number">1.8.7.4.</span> <span class="nav-text">测试索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="nav-number">1.8.7.5.</span> <span class="nav-text">联合索引</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="左大大"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">左大大</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/05/11/%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="左大大">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="左大大的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySql数据库
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-05-11 07:20:25" itemprop="dateCreated datePublished" datetime="2019-05-11T07:20:25+08:00">2019-05-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-01 12:22:34" itemprop="dateModified" datetime="2019-06-01T12:22:34+08:00">2019-06-01</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB%E7%B3%BB%E5%88%97/" itemprop="url" rel="index"><span itemprop="name">杂七杂八系列</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="MySQL数据库"><a href="#MySQL数据库" class="headerlink" title="MySQL数据库"></a>MySQL数据库</h2><h4 id="环境配置及服务制作"><a href="#环境配置及服务制作" class="headerlink" title="环境配置及服务制作"></a>环境配置及服务制作</h4><p>(安装:参考网站：<a target="_blank" rel="noopener" href="https://www.mysql.com/">https://www.mysql.com/</a>)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.每次启动mysql需要先切到对应的文件夹路径下才能操作太多繁琐将mysql所在的文件夹路径添加到系统环境变量中</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.将mysql制作成系统服务</span></span><br><span class="line">	   mysql--install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.移除mysql系统服务</span></span><br><span class="line">	   mysql --remove</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 查看当前计算机的运行进程数</span></span><br><span class="line">	services.msc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如何查看当前具体进程</span></span><br><span class="line">	tasklist</span><br><span class="line">	tasklist | findstr mysqld</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 如何杀死具体进程(只有管理员cmd窗口下才能成功)</span></span><br><span class="line">	taskkill /F /pid pid号</span><br></pre></td></tr></table></figure>

<h4 id="sql语句初识"><a href="#sql语句初识" class="headerlink" title="sql语句初识"></a>sql语句初识</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> MySQL中sql语句是以分号作为结束的标志</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> 基本命令:show databases;  查看所有的库名	</span><br><span class="line">    </span><br><span class="line"><span class="number">3</span> 连接服务端命令:mysql -uroot -p</span><br><span class="line">    </span><br><span class="line"><span class="number">4</span> 取消错误命令:\c</span><br><span class="line">    </span><br><span class="line"><span class="number">5</span> 客户端退出: quit <span class="keyword">or</span> exit</span><br></pre></td></tr></table></figure>

<h4 id="密码相关"><a href="#密码相关" class="headerlink" title="密码相关"></a>密码相关</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>设置密码:</span><br><span class="line">    mysqladmin -uroot -p原密码 password新密码</span><br><span class="line">    改命令直接在终端输入即可 无须进入客户端</span><br><span class="line">   </span><br><span class="line"><span class="number">2.</span>破解密码:</span><br><span class="line">    <span class="number">1.</span>先关闭当前mysql服务端</span><br><span class="line">        命令行的方式启动(让mysql跳过用户名密码验证功能)</span><br><span class="line">        mysqld --skip-grant-tables</span><br><span class="line"></span><br><span class="line">    <span class="number">2.</span>直接以无密码的方式连接</span><br><span class="line">        mysql -uroot -p    直接回车</span><br><span class="line"></span><br><span class="line">    <span class="number">3.</span>修改当前用户的密码</span><br><span class="line">        update mysql.user <span class="built_in">set</span> password=password(<span class="number">123456</span>) where </span><br><span class="line">        user=<span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> host=<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="number">4.</span>立即将修改数据刷到硬盘</span><br><span class="line">        flush privileges;</span><br><span class="line"></span><br><span class="line">    <span class="number">5.</span>关闭当前服务端 然后以正常校验授权表的形式启动</span><br></pre></td></tr></table></figure>

<h3 id="一-基本sql语句介绍"><a href="#一-基本sql语句介绍" class="headerlink" title="一.基本sql语句介绍"></a>一.基本sql语句介绍</h3><h5 id="1-针对库的增删改查-文件夹"><a href="#1-针对库的增删改查-文件夹" class="headerlink" title="1.针对库的增删改查(文件夹)"></a>1.针对库的增删改查(文件夹)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增</span></span><br><span class="line">	create database 库名;</span><br><span class="line">    create database 库名 charset=<span class="string">&#x27;gbk&#x27;</span>;</span><br><span class="line"><span class="comment"># 查</span></span><br><span class="line">	show databases;  <span class="comment"># 查所有</span></span><br><span class="line">    show create database 库名; <span class="comment"># 查单个</span></span><br><span class="line"><span class="comment"># 改</span></span><br><span class="line">	alter database 库名 charset=<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line"><span class="comment"># 删</span></span><br><span class="line">	drop database 库名;</span><br></pre></td></tr></table></figure>

<h5 id="2-针对表的增删改查-文件"><a href="#2-针对表的增删改查-文件" class="headerlink" title="2.针对表的增删改查(文件)"></a>2.针对表的增删改查(文件)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前所在库的名字</span></span><br><span class="line">	select database();</span><br><span class="line"><span class="comment"># 切换库</span></span><br><span class="line">	use 库名; </span><br><span class="line"><span class="comment"># 增 </span></span><br><span class="line">	create table 表名(<span class="built_in">id</span> <span class="built_in">int</span>,name char(<span class="number">4</span>));</span><br><span class="line">    create table 库名.表名(<span class="built_in">id</span> <span class="built_in">int</span>);</span><br><span class="line"><span class="comment"># 查</span></span><br><span class="line">	show tables; <span class="comment"># 查看当前库下所有表</span></span><br><span class="line">    show create table 表名; <span class="comment"># 查看单个</span></span><br><span class="line">    desc 表名;</span><br><span class="line"><span class="comment"># 改</span></span><br><span class="line">	alter table 表名 modify name char(<span class="number">12</span>);</span><br><span class="line"><span class="comment"># 删 </span></span><br><span class="line">	drop table 表名;</span><br></pre></td></tr></table></figure>

<h5 id="3-针对数据的增删改查-记录"><a href="#3-针对数据的增删改查-记录" class="headerlink" title="3.针对数据的增删改查(记录)"></a>3.针对数据的增删改查(记录)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增</span></span><br><span class="line">	insert into 表名 values(<span class="number">180</span>,<span class="string">&#x27;zqw&#x27;</span>);</span><br><span class="line">    insert into 表名 values(<span class="number">180</span>,<span class="string">&#x27;zqw&#x27;</span>),(<span class="number">170</span>,<span class="string">&#x27;lqz&#x27;</span>),(<span class="number">3</span>,<span class="string">&#x27;zhh&#x27;</span>);</span><br><span class="line"><span class="comment"># 查</span></span><br><span class="line">	select * <span class="keyword">from</span> 表名;  <span class="comment"># 该命令当数据量特别大的时候不建议使用</span></span><br><span class="line">    select <span class="built_in">id</span>,name <span class="keyword">from</span> 表名;</span><br><span class="line"><span class="comment"># 改</span></span><br><span class="line">	update 表名 <span class="built_in">set</span> name=<span class="string">&#x27;dsb&#x27;</span> where <span class="built_in">id</span>&gt;<span class="number">1</span>;</span><br><span class="line"><span class="comment"># 删 </span></span><br><span class="line">	delete <span class="keyword">from</span> 表名 where <span class="built_in">id</span>&gt;<span class="number">1</span>;</span><br><span class="line">    delete <span class="keyword">from</span> 表名 where name=<span class="string">&#x27;zhh&#x27;</span>;</span><br><span class="line"><span class="comment"># 将表中所有数据清空</span></span><br><span class="line">	delete <span class="keyword">from</span> 表名; </span><br></pre></td></tr></table></figure>

<h5 id="4-创建表的完整语法"><a href="#4-创建表的完整语法" class="headerlink" title="4.创建表的完整语法"></a>4.创建表的完整语法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">	字段名<span class="number">1</span> 字段类型(宽度) 约束条件,</span><br><span class="line">    字段名<span class="number">2</span> 字段类型(宽度) 约束条件,</span><br><span class="line">    字段名<span class="number">3</span> 字段类型(宽度) 约束条件</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">    <span class="number">1.</span>字段名和字段类型是必须的 宽度和约束条件是可选的</span><br><span class="line">    <span class="number">2.</span>约束条件可以有多个</span><br><span class="line">    <span class="number">3.</span>最后一个字段结尾不能加逗号</span><br></pre></td></tr></table></figure>

<h3 id="二-存储引擎"><a href="#二-存储引擎" class="headerlink" title="二.存储引擎"></a>二.存储引擎</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>什么是存储引擎?  存储数据的方式</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>查看所有存储引擎:</span><br><span class="line">	show engines;</span><br><span class="line">   </span><br><span class="line"><span class="number">3.</span>常见存储引擎:</span><br><span class="line">	MyISAM</span><br><span class="line">    	用处：mysql <span class="number">5.5</span> 版本之前默认存储数据的方式</span><br><span class="line">        特点：存储速度很快，但是功能偏少且安全性较低</span><br><span class="line">    InnoDB</span><br><span class="line">		用处：mysql <span class="number">5.6</span> 版本之后默认存储数据的方式</span><br><span class="line">        特点：存储数据没有MyISAM速度快，但是功能和安全性更高一筹</span><br><span class="line">        		事物	行锁	外键</span><br><span class="line">    BlackHole</span><br><span class="line">    	用处：使用该引擎后往里面写入的东西都会直接消失</span><br><span class="line">    memory</span><br><span class="line">    	用处：将数据存储在内存中</span><br><span class="line">        (断电数据丢失，不可永久保存)</span><br><span class="line">        </span><br><span class="line"><span class="number">4.</span>各存储引擎之间区别(文件结构):</span><br><span class="line">	InnoDB</span><br><span class="line">    	.frm    表结构</span><br><span class="line">       	.ibd    表数据和索引(类似于书的目录)</span><br><span class="line">        </span><br><span class="line">    MyISAM</span><br><span class="line">    	.frm    表结构</span><br><span class="line">        .MYD    表数据</span><br><span class="line">        .myi	索引</span><br><span class="line">        </span><br><span class="line">    BlackHole</span><br><span class="line">    	.frm	表结构</span><br><span class="line">     </span><br><span class="line">    Memory</span><br><span class="line">    	.frm	表结构</span><br></pre></td></tr></table></figure>

<h3 id="三-MySQL基本数据类型"><a href="#三-MySQL基本数据类型" class="headerlink" title="三.MySQL基本数据类型"></a>三.MySQL基本数据类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>整型</span><br><span class="line">	tinyint, smallint, <span class="built_in">int</span>, bigint...</span><br><span class="line">	<span class="number">1.</span>不同的类型能够存储的数字范围不一样</span><br><span class="line">    <span class="number">2.</span>验证是否自带符号</span><br><span class="line">    	create table t5(<span class="built_in">id</span> tinyint);</span><br><span class="line">        insert into t5 values(-<span class="number">129</span>),(<span class="number">256</span>);</span><br><span class="line">        </span><br><span class="line">    结论:所有的整型都是自带符号    </span><br><span class="line">    去除整型符号:create table t6(<span class="built_in">id</span> tinyint unsigned);</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>浮点型</span><br><span class="line">	<span class="built_in">float</span>(<span class="number">255</span>,<span class="number">30</span>)</span><br><span class="line">    	总共<span class="number">255</span>位小数占<span class="number">30</span>位</span><br><span class="line">    double(<span class="number">255</span>,<span class="number">30</span>)</span><br><span class="line">    	总共<span class="number">255</span>位小数占<span class="number">30</span>位</span><br><span class="line">    decimal(<span class="number">65</span>,<span class="number">30</span>)</span><br><span class="line">    	总共<span class="number">65</span>位小数占<span class="number">30</span>位</span><br><span class="line"></span><br><span class="line">	精确度: <span class="built_in">float</span> &lt; double &lt; decimal</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>字符类型</span><br><span class="line">	char(<span class="number">4</span>)</span><br><span class="line">    	最大存储四个字符 超出了直接报错 不超过空格填充至四位</span><br><span class="line">    varchar(<span class="number">4</span>)</span><br><span class="line">    	最大存储四个字符 超出了直接报错 不超过有几位存几位</span><br><span class="line">        </span><br><span class="line">     对比:</span><br><span class="line">        char(<span class="number">4</span>)</span><br><span class="line">			优点：整存整取 速度快</span><br><span class="line">    		缺点：浪费硬盘空间</span><br><span class="line"></span><br><span class="line">		varchar(<span class="number">4</span>)</span><br><span class="line">			优点：节省硬盘空间</span><br><span class="line">    		缺点：存取速度没有char快</span><br><span class="line">        </span><br><span class="line"><span class="number">4.</span>日期类型</span><br><span class="line">	datetime		年月日 时分秒</span><br><span class="line">    time			时分秒</span><br><span class="line">    date			年月日</span><br><span class="line">    year			年</span><br><span class="line">   </span><br><span class="line"><span class="number">5.</span>枚举与集合</span><br><span class="line">	枚举		多选一</span><br><span class="line">    	create table t14(</span><br><span class="line">        	<span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">            name char(<span class="number">16</span>),</span><br><span class="line">            gender enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="string">&#x27;others&#x27;</span>)</span><br><span class="line">        );</span><br><span class="line">    </span><br><span class="line">    集合		多选多(多选一)</span><br><span class="line">    	create table t15(</span><br><span class="line">        	<span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">            name char(<span class="number">32</span>),</span><br><span class="line">            hobby <span class="built_in">set</span>(<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;study&#x27;</span>,<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;tea&#x27;</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">特例：</span><br><span class="line">	针对整型字段 括号里面的数字不是用来限制存储长度而是用来控制展示长度,定义整型字段无需自己写括号和数字 </span><br></pre></td></tr></table></figure>

<h5 id="设置严格模式"><a href="#设置严格模式" class="headerlink" title="设置严格模式"></a>设置严格模式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>查看sql_mode</span><br><span class="line">	show variables like <span class="string">&#x27;%mode%&#x27;</span>;</span><br><span class="line"><span class="number">2.</span>修改</span><br><span class="line">	<span class="built_in">set</span> <span class="keyword">global</span> sql_mode=<span class="string">&#x27;strict_trans_tables&#x27;</span>;</span><br><span class="line"><span class="number">3.</span>退出客户端重新进入即可</span><br><span class="line"><span class="number">4.</span>验证是否自动填充</span><br><span class="line">	<span class="built_in">set</span> <span class="keyword">global</span> sql_mode=<span class="string">&#x27;strict_trans_tables,pad_char_to_full_length&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="四-约束条件-掌握"><a href="#四-约束条件-掌握" class="headerlink" title="四.约束条件(掌握)"></a>四.约束条件(掌握)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>约束条件:</span><br><span class="line">    限制表中的数据,保证添加到数据表中数据准确性和可靠性,不符合条件不可添加</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>常见常用约束条件:</span><br><span class="line">	<span class="number">1.</span><span class="keyword">not</span> null</span><br><span class="line">    	非空约束,保证字段内值不能为空</span><br><span class="line">    <span class="number">2.</span>zerofill</span><br><span class="line">    	填充,用<span class="number">0</span>代替空格填充</span><br><span class="line">   	<span class="number">3.</span>unsgined</span><br><span class="line">    	无符号约束,去除整型中符号</span><br><span class="line">    <span class="number">4.</span>default</span><br><span class="line">    	默认约束,后面跟条件</span><br><span class="line">    <span class="number">5.</span>unique</span><br><span class="line">    	唯一约束,保证字段内出现的值唯一</span><br><span class="line">            <span class="number">1.</span>单列唯一</span><br><span class="line">            create table 表名(</span><br><span class="line">                <span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">                ip varchar(<span class="number">32</span>) unique</span><br><span class="line">            );</span><br><span class="line">            <span class="number">2.</span>多列唯一</span><br><span class="line">            create table 表名(</span><br><span class="line">                <span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">                ip varchar(<span class="number">32</span>),</span><br><span class="line">                port <span class="built_in">int</span>,</span><br><span class="line">                unique(ip,port)</span><br><span class="line">            );</span><br><span class="line">     <span class="number">6.</span>primary key</span><br><span class="line">    	主键约束</span><br><span class="line">            <span class="number">1.</span>单从限制角度看,主键相当于非空且唯一</span><br><span class="line">                primary key == <span class="keyword">not</span> null unquie</span><br><span class="line">            <span class="number">2.</span>InnoDB存储引擎规定在创建表的时候必须有且只有一个主键</span><br><span class="line">                <span class="number">1.</span>没有主键但是有非空且唯一的字段,那么其会自动升级为主键</span><br><span class="line">                <span class="number">2.</span>为什么创建表的时候没有主键也可以创建?</span><br><span class="line">                    <span class="number">1.</span>当表中没有约束条件,为了顺利创建出表,InnoDB存储引擎会采用内部隐藏字段作为主键</span><br><span class="line">                    <span class="number">2.</span>主键可以帮助我们加快数据的查询速度</span><br><span class="line">                结论:</span><br><span class="line">                    创建表的时候一般会创建一个<span class="built_in">id</span>字段并将设置为主键</span><br><span class="line">                </span><br><span class="line">      <span class="number">7.</span>auto_increment</span><br><span class="line">    	 自增约束</span><br><span class="line">             <span class="number">1.</span>单一主键</span><br><span class="line">                专门用来给key键使用(专门给主键用)</span><br><span class="line">                    create table 表名(</span><br><span class="line">                        <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">                        name varchar(<span class="number">32</span>)</span><br><span class="line">                    );</span><br><span class="line">             <span class="number">2.</span>联合主键</span><br><span class="line">                 create table 表名(</span><br><span class="line">                    <span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">                     nid <span class="built_in">int</span>,</span><br><span class="line">                     name varchar(<span class="number">32</span>),</span><br><span class="line">                     primary key(<span class="built_in">id</span>,nid)...</span><br><span class="line">                 );</span><br><span class="line"></span><br><span class="line">注意:主键字段的固定写法为<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment  	</span><br></pre></td></tr></table></figure>

<h5 id="1-主键的特征"><a href="#1-主键的特征" class="headerlink" title="1.主键的特征"></a>1.主键的特征</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>delete <span class="keyword">from</span> </span><br><span class="line">	不会影响主键的自增</span><br><span class="line"><span class="number">2.</span>truncate</span><br><span class="line">	清空表数据并且重置主键</span><br></pre></td></tr></table></figure>

<h5 id="2-外键"><a href="#2-外键" class="headerlink" title="2.外键"></a>2.外键</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">id</span> emp_name emp_salary dep_name dep_desc</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>问题</span><br><span class="line">    <span class="number">1.</span>表结构不够明确(忽略)</span><br><span class="line">        到底是员工表还是部门表</span><br><span class="line">    <span class="number">2.</span>浪费存储空间(忽略)</span><br><span class="line">        硬盘不值钱 不够花钱买</span><br><span class="line">    <span class="number">3.</span>表扩展性极差(不能忽略)</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>拆分</span><br><span class="line">	拆分表后上述三个问题都可以解决,但是员工和部门之间就没有了关联</span><br><span class="line">    </span><br><span class="line">    外键字段:</span><br><span class="line">        用来建立表与表之间的关系的字段</span><br><span class="line">    外键语法:</span><br><span class="line">        被关联表名_<span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">        foreign key(被关联表名_<span class="built_in">id</span>) references 被关联表名(<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<h5 id="3-级联更新-级联删除"><a href="#3-级联更新-级联删除" class="headerlink" title="3.级联更新  级联删除"></a>3.级联更新  级联删除</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create table dep(</span><br><span class="line">	<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">    dep_name varchar(<span class="number">32</span>),</span><br><span class="line">    dep_desc varchar(<span class="number">64</span>)    </span><br><span class="line">);</span><br><span class="line">create table emp(</span><br><span class="line">	<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">    emp_name varchar(<span class="number">32</span>),</span><br><span class="line">    emp_salary <span class="built_in">int</span>,</span><br><span class="line">    dep_id <span class="built_in">int</span>,</span><br><span class="line">    foreign key(dep_id) references dep(<span class="built_in">id</span>) </span><br><span class="line">    on update cascade  <span class="comment"># 级联更新</span></span><br><span class="line">    on delete cascade  <span class="comment"># 级联删除</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h5 id="4-表关系"><a href="#4-表关系" class="headerlink" title="4.表关系"></a>4.表关系</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>表关系分类:</span><br><span class="line">    	<span class="number">1.</span>一对一</span><br><span class="line">   	 	<span class="number">2.</span>一对多</span><br><span class="line">    	<span class="number">3.</span>多对多</span><br><span class="line">    	<span class="number">4.</span>没有关系</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>表关系判断要进行<span class="string">&#x27;换位思考&#x27;</span></span><br><span class="line">    <span class="number">1.</span>先创建基本字段</span><br><span class="line">    <span class="number">2.</span>再考虑外键字段</span><br><span class="line"> </span><br><span class="line">注意:</span><br><span class="line">    <span class="number">1.</span>在创建表的时候先创建被关联的表(没有外键字段的表)</span><br><span class="line">    <span class="number">2.</span>在录入数据的时候先录入被关联表的数据</span><br><span class="line">    <span class="number">3.</span>修改或者删除被关联表数据</span><br><span class="line">    </span><br><span class="line"><span class="number">3.</span>表关系分析:    </span><br><span class="line">*******************一对一********************</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">作者表与作者详情表</span></span><br><span class="line"><span class="string">	1.作者角度:</span></span><br><span class="line"><span class="string">		问:一个作者是否可以对应多个作者详情表?</span></span><br><span class="line"><span class="string">		答:不可以</span></span><br><span class="line"><span class="string">	2.作者详情表角度:</span></span><br><span class="line"><span class="string">		问:一份作者详情表是否可以对应多个作者?</span></span><br><span class="line"><span class="string">		答:不可以</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	总结:</span></span><br><span class="line"><span class="string">		双方对应关系都不成立,那么就称之为一对一关系</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">创建基础表:</span><br><span class="line">    create table authorinfo(</span><br><span class="line">    	<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">        phone <span class="built_in">int</span>,</span><br><span class="line">        addr varchar(<span class="number">32</span>)</span><br><span class="line">    );</span><br><span class="line">    create table author(</span><br><span class="line">    	<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">        name varchar(<span class="number">32</span>),</span><br><span class="line">        age <span class="built_in">int</span>,</span><br><span class="line">        authorinfo_id <span class="built_in">int</span> unique,</span><br><span class="line">        foreign key(authorinfo_id) references authorinfo(<span class="built_in">id</span>)</span><br><span class="line">        on update cascade</span><br><span class="line">        on delete cascade</span><br><span class="line">    );</span><br><span class="line">录入数据:</span><br><span class="line">    insert into authorinfo(phone,addr) values(<span class="number">110</span>,<span class="string">&#x27;安徽&#x27;</span>),(<span class="number">120</span>,<span class="string">&#x27;四川&#x27;</span>);</span><br><span class="line">    insert into author(name,age,authorinfo_id) values(<span class="string">&#x27;zxx&#x27;</span>,<span class="number">21</span>,<span class="number">1</span>),(<span class="string">&#x27;lxx&#x27;</span>,<span class="number">18</span>,<span class="number">2</span>);</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">*******************一对多********************</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">班级表和学生表</span></span><br><span class="line"><span class="string">	1.班级角度:</span></span><br><span class="line"><span class="string">		问:一个班级是否可以对应多个学生?</span></span><br><span class="line"><span class="string">		答:可以</span></span><br><span class="line"><span class="string">	2.学生角度:</span></span><br><span class="line"><span class="string">		问:一个学生是否可以对应多个班级?</span></span><br><span class="line"><span class="string">		答:不可以</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	总结:</span></span><br><span class="line"><span class="string">		双方对应关系只有一方成立,那么就称之为一对多关系</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">创建基础表:</span><br><span class="line">    create table <span class="class"><span class="keyword">class</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">    	<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">        grade varchar(<span class="params"><span class="number">32</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class">    </span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">create</span> <span class="title">table</span> <span class="title">student</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">    	<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">        name varchar(<span class="params"><span class="number">32</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="class">        age <span class="built_in">int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">        gender enum(<span class="params"><span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="string">&#x27;othders&#x27;</span></span>) default <span class="string">&#x27;male&#x27;</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">        class_id <span class="built_in">int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">        foreign key (<span class="params">class_id</span>) references <span class="keyword">class</span>(<span class="params"><span class="built_in">id</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class">        on update cascade</span></span></span><br><span class="line"><span class="params"><span class="class">        on delete cascade</span></span></span><br><span class="line"><span class="params"><span class="class">     </span>);</span></span><br><span class="line"><span class="class">       </span></span><br><span class="line"><span class="class">录入数据:</span>  	</span><br><span class="line">      insert into <span class="class"><span class="keyword">class</span>(<span class="params">grade</span>) <span class="title">values</span>(<span class="params"><span class="string">&#x27;一班&#x27;</span></span>),(<span class="params"><span class="string">&#x27;二班&#x27;</span></span>);</span></span><br><span class="line"><span class="class">      <span class="title">insert</span> <span class="title">into</span> <span class="title">student</span>(<span class="params">name,age,class_id</span>) <span class="title">values</span>(<span class="params"><span class="string">&#x27;zqw&#x27;</span>,<span class="number">21</span>,<span class="number">1</span></span>),(<span class="params"><span class="string">&#x27;zhh&#x27;</span>,<span class="number">18</span>,<span class="number">1</span></span>),(<span class="params"><span class="string">&#x27;lqz&#x27;</span>,<span class="number">38</span>,<span class="number">2</span></span>);</span></span><br><span class="line"><span class="class">        </span></span><br><span class="line"><span class="class">        </span></span><br><span class="line"><span class="class">*******************多对多********************</span></span><br><span class="line"><span class="class">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="class">书籍表与出版社表</span></span><br><span class="line"><span class="class">	1.书籍角度:</span></span><br><span class="line">		问:一门书籍是非可以对应多个出版社?</span><br><span class="line">		答:可以</span><br><span class="line">	<span class="number">2.</span>出版社角度:</span><br><span class="line">		问:一个出版社是否可以对应多门书籍?</span><br><span class="line">		答:可以</span><br><span class="line">	</span><br><span class="line">	总结:</span><br><span class="line">		双方对应关系都成立,那么就称之为多对多关系</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">创建基础表:</span></span><br><span class="line"><span class="string">    create table book(</span></span><br><span class="line"><span class="string">    	id int primary key auto_increment,</span></span><br><span class="line"><span class="string">        name varchar(32),</span></span><br><span class="line"><span class="string">        price int</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">    create table press(</span></span><br><span class="line"><span class="string">    	id int primary key auto_increment,</span></span><br><span class="line"><span class="string">        name varchar(32),</span></span><br><span class="line"><span class="string">        year int</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    create table book_press(</span></span><br><span class="line"><span class="string">    	id int primary key auto_increment,</span></span><br><span class="line"><span class="string">        book_id int,</span></span><br><span class="line"><span class="string">        foreign key(book_id) references book(id)</span></span><br><span class="line"><span class="string">        on update cascade</span></span><br><span class="line"><span class="string">        on delete cascade,</span></span><br><span class="line"><span class="string">        press_id int,</span></span><br><span class="line"><span class="string">        foreign key(press_id) references press(id)</span></span><br><span class="line"><span class="string">        on update cascade</span></span><br><span class="line"><span class="string">        on delete cascade</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">录入数据:</span></span><br><span class="line"><span class="string">     insert into book(name,price) values(&#x27;水浒传&#x27;,500),(&#x27;红楼梦&#x27;,800),(&#x27;西游记&#x27;,600);</span></span><br><span class="line"><span class="string">     insert into press(name,year) values(&#x27;北大出版社&#x27;,1999),(&#x27;清华出版社&#x27;,2000);</span></span><br><span class="line"><span class="string">     insert into book_press(book_id,press_id) values(1,1),(1,2),(2,1),(3,1);</span></span><br></pre></td></tr></table></figure>

<h3 id="五-查询关键字"><a href="#五-查询关键字" class="headerlink" title="五.查询关键字"></a>五.查询关键字</h3><h5 id="前期表准备"><a href="#前期表准备" class="headerlink" title="前期表准备"></a>前期表准备</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">create table emp(</span><br><span class="line">  <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">  name varchar(<span class="number">20</span>) <span class="keyword">not</span> null,</span><br><span class="line">  sex enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>) <span class="keyword">not</span> null default <span class="string">&#x27;male&#x27;</span>, <span class="comment">#大部分是男的</span></span><br><span class="line">  age <span class="built_in">int</span>(<span class="number">3</span>) unsigned <span class="keyword">not</span> null default <span class="number">28</span>,</span><br><span class="line">  hire_date date <span class="keyword">not</span> null,</span><br><span class="line">  post varchar(<span class="number">50</span>),</span><br><span class="line">  post_comment varchar(<span class="number">100</span>),</span><br><span class="line">  salary double(<span class="number">15</span>,<span class="number">2</span>),</span><br><span class="line">  office <span class="built_in">int</span>, <span class="comment">#一个部门一个屋子</span></span><br><span class="line">  depart_id <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入记录</span></span><br><span class="line"><span class="comment">#三个部门：教学，销售，运营</span></span><br><span class="line">insert into emp(name,sex,age,hire_date,post,salary,office,depart_id) values</span><br><span class="line">(<span class="string">&#x27;jason&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20170301&#x27;</span>,<span class="string">&#x27;张江第一帅形象代言&#x27;</span>,<span class="number">7300.33</span>,<span class="number">401</span>,<span class="number">1</span>), <span class="comment">#以下是教学部</span></span><br><span class="line">(<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">78</span>,<span class="string">&#x27;20150302&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">1000000.31</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;kevin&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">81</span>,<span class="string">&#x27;20130305&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">8300</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;tony&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">73</span>,<span class="string">&#x27;20140701&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">3500</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;owen&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;20121101&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">2100</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20110211&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">9000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;jenny&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;19000301&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">30000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;sank&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">48</span>,<span class="string">&#x27;20101111&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">10000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;哈哈&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">48</span>,<span class="string">&#x27;20150311&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">3000.13</span>,<span class="number">402</span>,<span class="number">2</span>),<span class="comment">#以下是销售部门</span></span><br><span class="line">(<span class="string">&#x27;呵呵&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">38</span>,<span class="string">&#x27;20101101&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">2000.35</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;西西&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20110312&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">1000.37</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;乐乐&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20160513&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">3000.29</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;拉拉&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;20170127&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">4000.33</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;僧龙&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;20160311&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">10000.13</span>,<span class="number">403</span>,<span class="number">3</span>), <span class="comment">#以下是运营部门</span></span><br><span class="line">(<span class="string">&#x27;程咬金&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;19970312&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">20000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;程咬银&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20130311&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">19000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;程咬铜&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20150411&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">18000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;程咬铁&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20140512&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">17000</span>,<span class="number">403</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h5 id="1-查询关键字之where-筛选数据"><a href="#1-查询关键字之where-筛选数据" class="headerlink" title="1.查询关键字之where(筛选数据)"></a>1.查询关键字之where(筛选数据)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">where:</span><br><span class="line">    筛选数据,后面跟条件</span><br><span class="line"><span class="number">1.</span>where后可跟:</span><br><span class="line">	<span class="number">1.</span>比较运算符</span><br><span class="line">    <span class="number">2.</span>逻辑运算符</span><br><span class="line">    <span class="number">3.</span>模糊查询</span><br><span class="line">        关键字:  </span><br><span class="line">		   like</span><br><span class="line">        关键符号:</span><br><span class="line">            %:匹配任意个数的任意字符</span><br><span class="line">            _:匹配单个个数的任意字符_</span><br><span class="line">     <span class="number">4.</span>成员运算</span><br><span class="line">     <span class="number">5.</span>身份运算</span><br><span class="line">    <span class="number">1.</span>查询<span class="built_in">id</span>大于等于<span class="number">3</span>小于等于<span class="number">6</span>的数据</span><br><span class="line">   		select <span class="built_in">id</span>,name <span class="keyword">from</span> emp where <span class="built_in">id</span> &gt;= <span class="number">3</span> <span class="keyword">and</span> <span class="built_in">id</span> &lt;= <span class="number">6</span>;</span><br><span class="line">    	select *  <span class="keyword">from</span> emp where <span class="built_in">id</span> between <span class="number">3</span> <span class="keyword">and</span> <span class="number">6</span>;  </span><br><span class="line"></span><br><span class="line">    <span class="number">2.</span>查询薪资是<span class="number">20000</span>或者<span class="number">18000</span>或者<span class="number">17000</span>的数据</span><br><span class="line">    	select * <span class="keyword">from</span> emp where salary = <span class="number">20000</span> <span class="keyword">or</span> salary = <span class="number">18000</span> <span class="keyword">or</span> salary = <span class="number">17000</span>;</span><br><span class="line">    	select * <span class="keyword">from</span> emp where salary <span class="keyword">in</span> (<span class="number">20000</span>,<span class="number">18000</span>,<span class="number">17000</span>);  </span><br><span class="line"></span><br><span class="line">    <span class="number">3.</span>查询姓名中带有字母o的员工姓名和薪资</span><br><span class="line">    select name,salary <span class="keyword">from</span> emp where name like <span class="string">&#x27;%o%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="number">4.</span>查询姓名由四个字符组成的员工姓名和薪资</span><br><span class="line">    select name,salary <span class="keyword">from</span> emp where name like <span class="string">&#x27;____&#x27;</span>;</span><br><span class="line">    select name,salary <span class="keyword">from</span> emp where char_length(name) =<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="number">5.</span>查询<span class="built_in">id</span>小于<span class="number">3</span>或者大于<span class="number">6</span>的数据</span><br><span class="line">    select *  <span class="keyword">from</span> emp where <span class="built_in">id</span> <span class="keyword">not</span> between <span class="number">3</span> <span class="keyword">and</span> <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="number">6.</span>查询薪资不在<span class="number">20000</span>，<span class="number">18000</span>，<span class="number">17000</span>范围的数据</span><br><span class="line">    select * <span class="keyword">from</span> emp where salary <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">20000</span>,<span class="number">18000</span>,<span class="number">17000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="number">7.</span>查询岗位描述为空的员工名与岗位名  针对null不能用等号，只能用<span class="keyword">is</span></span><br><span class="line">    select name,post <span class="keyword">from</span> emp where post_comment = NULL;  <span class="comment"># 查询为空！</span></span><br><span class="line">    select name,post <span class="keyword">from</span> emp where post_comment <span class="keyword">is</span> NULL;</span><br><span class="line">    select name,post <span class="keyword">from</span> emp where post_comment <span class="keyword">is</span> <span class="keyword">not</span> NULL;</span><br></pre></td></tr></table></figure>

<h5 id="2-查询关键字之group-by-分组"><a href="#2-查询关键字之group-by-分组" class="headerlink" title="2.查询关键字之group by(分组)"></a>2.查询关键字之group by(分组)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">分组:</span><br><span class="line">	将单个单个的个体按照指定的条件分成一个个整体</span><br><span class="line"></span><br><span class="line">注意:</span><br><span class="line">	分组之后默认只能直接获取到分组的依据其他字段无法再直接获取(可以间接获取)</span><br><span class="line"><span class="number">1.</span>group by</span><br><span class="line"></span><br><span class="line">    设置严格模式</span><br><span class="line">    <span class="built_in">set</span> <span class="keyword">global</span> sql_mode=<span class="string">&#x27;STRICT_TRANS_TABLES,PAD_CHAR_TO_FULL_LENGTH,only_full_group_by&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1.</span>每个部门的最高薪资</span><br><span class="line">    select post,<span class="built_in">max</span>(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line">    </span><br><span class="line">    <span class="number">2.</span>每个部门的最低薪资</span><br><span class="line">    select post,<span class="built_in">min</span>(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line">    </span><br><span class="line">    <span class="number">3.</span>每个部门的平均薪资</span><br><span class="line">    select post,avg(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line">    </span><br><span class="line">    <span class="number">4.</span>每个部门的人数</span><br><span class="line">    select post,count(<span class="built_in">id</span>) <span class="keyword">from</span> emp group by post;</span><br><span class="line">    </span><br><span class="line">    <span class="number">5.</span>每个部门的月工资总和</span><br><span class="line">    select post,<span class="built_in">sum</span>(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>group_concat()  获取分组以外的字段数据 并且支持拼接操作</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>concat()  未分组之前使用的拼接功能</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>concat_ws()  分组之后使用的拼接功能</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span><span class="keyword">as</span>语法  更改表或库的名称</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>聚合函数(分组后使用)</span><br><span class="line">    分组之后频繁需要使用的</span><br><span class="line">        <span class="built_in">max</span>		最大值</span><br><span class="line">        <span class="built_in">min</span>		最小值</span><br><span class="line">        <span class="built_in">sum</span>		求和</span><br><span class="line">        count	计数</span><br><span class="line">        avg		平均值</span><br></pre></td></tr></table></figure>

<h5 id="3-查询关键字之having-筛选数据"><a href="#3-查询关键字之having-筛选数据" class="headerlink" title="3.查询关键字之having(筛选数据)"></a>3.查询关键字之having(筛选数据)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>having</span><br><span class="line">    功能上having与where是一模一样的</span><br><span class="line">    但是使用位置上有所不同</span><br><span class="line">        <span class="number">1.</span>where在分组之前使用</span><br><span class="line">        <span class="number">2.</span>having在分组之后使用</span><br><span class="line"> </span><br><span class="line"><span class="number">1.</span>统计各部门年龄在<span class="number">30</span>岁以上的员工平均工资，并且保留平均工资大于<span class="number">10000</span>的部门</span><br><span class="line"></span><br><span class="line">    <span class="number">1.</span>先筛选出所有<span class="number">30</span>岁以上的员工</span><br><span class="line">        select * <span class="keyword">from</span> emp where age&gt;<span class="number">30</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="number">2.</span>然后再按照部门分组</span><br><span class="line">        select post,avg(salary) <span class="keyword">from</span> emp where age&gt;<span class="number">30</span> group by post;</span><br><span class="line">        </span><br><span class="line">    <span class="number">3.</span>分组之后做过滤操作</span><br><span class="line">        select post,avg(salary) <span class="keyword">from</span> emp </span><br><span class="line">            where age&gt;<span class="number">30</span> </span><br><span class="line">            group by post </span><br><span class="line">            having avg(salary)&gt;<span class="number">10000</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="4-查询关键字之distinct-去重"><a href="#4-查询关键字之distinct-去重" class="headerlink" title="4.查询关键字之distinct(去重)"></a>4.查询关键字之distinct(去重)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>distinct</span><br><span class="line">    去重有一个非常严格的前提条件 数据必须是完全一样</span><br><span class="line">        如果数据带有主键那么肯定无法去重</span><br><span class="line">    select distinct age <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h5 id="5-查询关键字之order-by-排序"><a href="#5-查询关键字之order-by-排序" class="headerlink" title="5.查询关键字之order by(排序)"></a>5.查询关键字之order by(排序)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>order by</span><br><span class="line">	排序,默认是升序,更改关键字实现降序</span><br><span class="line">    </span><br><span class="line">    select * <span class="keyword">from</span> emp order by salary;  <span class="comment"># 默认升序</span></span><br><span class="line">    select * <span class="keyword">from</span> emp order by salary asc;  <span class="comment"># asc升序关键字 可不写</span></span><br><span class="line">    select * <span class="keyword">from</span> emp order by salary desc;  <span class="comment"># desc降序</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1.</span>排序也可以指定多个字段</span><br><span class="line">    	select * <span class="keyword">from</span> emp order by age desc,salary asc;</span><br><span class="line"></span><br><span class="line">    <span class="number">2.</span>统计各部门年龄在<span class="number">10</span>岁以上的员工平均工资，并且保留平均工资大于<span class="number">1000</span>的部门，然后对平均工		资进行排序</span><br><span class="line">        select post,avg(salary) <span class="keyword">from</span> emp </span><br><span class="line">            where age&gt;<span class="number">10</span></span><br><span class="line">            group by post</span><br><span class="line">            having avg(salary)&gt;<span class="number">1000</span></span><br><span class="line">            order by avg(salary);</span><br></pre></td></tr></table></figure>

<h5 id="6-查询关键字之limit-分页"><a href="#6-查询关键字之limit-分页" class="headerlink" title="6.查询关键字之limit(分页)"></a>6.查询关键字之limit(分页)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>limit</span><br><span class="line">	用来限制数据的展示条数,可指定展示起始位置</span><br><span class="line">    </span><br><span class="line">    select * <span class="keyword">from</span> emp limit <span class="number">5</span>;  <span class="comment"># 前五条</span></span><br><span class="line">	select * <span class="keyword">from</span> emp limit <span class="number">5</span>,<span class="number">5</span>;  <span class="comment"># 起始位置、条数</span></span><br><span class="line"></span><br><span class="line">	<span class="number">1.</span>查询工资最高的人的详细信息	</span><br><span class="line">		select * <span class="keyword">from</span> emp order by salary desc limit <span class="number">1</span>; </span><br></pre></td></tr></table></figure>

<h5 id="7-查询关键字之regexp-正则"><a href="#7-查询关键字之regexp-正则" class="headerlink" title="7.查询关键字之regexp(正则)"></a>7.查询关键字之regexp(正则)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>regexp</span><br><span class="line">	正则表达式</span><br><span class="line">	用一些特殊符号的组合去字符串中筛选出符合条件的数据</span><br><span class="line">   	</span><br><span class="line">    例:</span><br><span class="line">        select * <span class="keyword">from</span> emp where name regexp <span class="string">&#x27;^j.*(n|y)$&#x27;</span>;</span><br><span class="line">        <span class="comment"># &#x27;^j.*(n|y)$&#x27;  j开头 中间无所谓 n或者y结尾</span></span><br></pre></td></tr></table></figure>

<h3 id="六-多表查询"><a href="#六-多表查询" class="headerlink" title="六.多表查询"></a>六.多表查询</h3><h5 id="多表查询思想"><a href="#多表查询思想" class="headerlink" title="多表查询思想"></a>多表查询思想</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>子查询</span><br><span class="line">	分步解决问题</span><br><span class="line">    将一条SQL语句的查询结果用括号括起来当作另外一条SQL语句的查询条件</span><br><span class="line"> </span><br><span class="line"><span class="number">2.</span>连表操作</span><br><span class="line">      先将所有需要用到的表拼接到一起(一张表)</span><br><span class="line">      然后就是转换成单表查询</span><br></pre></td></tr></table></figure>

<h5 id="前期表准备-1"><a href="#前期表准备-1" class="headerlink" title="前期表准备"></a>前期表准备</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建表</span></span><br><span class="line">create table dep(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">20</span>) </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table emp(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">20</span>),</span><br><span class="line">sex enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>) <span class="keyword">not</span> null default <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">age <span class="built_in">int</span>,</span><br><span class="line">dep_id <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入数据</span></span><br><span class="line">insert into dep values</span><br><span class="line">(<span class="number">200</span>,<span class="string">&#x27;技术&#x27;</span>),</span><br><span class="line">(<span class="number">201</span>,<span class="string">&#x27;人力资源&#x27;</span>),</span><br><span class="line">(<span class="number">202</span>,<span class="string">&#x27;销售&#x27;</span>),</span><br><span class="line">(<span class="number">203</span>,<span class="string">&#x27;运营&#x27;</span>);</span><br><span class="line"></span><br><span class="line">insert into emp(name,sex,age,dep_id) values</span><br><span class="line">(<span class="string">&#x27;jason&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">48</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">&#x27;kevin&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">&#x27;nick&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">28</span>,<span class="number">202</span>),</span><br><span class="line">(<span class="string">&#x27;owen&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="number">203</span>),</span><br><span class="line">(<span class="string">&#x27;jerry&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="number">204</span>);</span><br></pre></td></tr></table></figure>

<h4 id="1-子查询"><a href="#1-子查询" class="headerlink" title="1.子查询"></a>1.子查询</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>查询jason所在的部门名称</span><br><span class="line">	第一步 先获取jason所在的部门<span class="built_in">id</span></span><br><span class="line">    	select dep_id <span class="keyword">from</span> emp where name=<span class="string">&#x27;jason&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">   	第二步 根据<span class="built_in">id</span>号去部门表中筛选</span><br><span class="line">    	select * <span class="keyword">from</span> dep where <span class="built_in">id</span> = <span class="number">200</span>;</span><br><span class="line">    </span><br><span class="line">    完整句式</span><br><span class="line">    	select * <span class="keyword">from</span> dep where <span class="built_in">id</span>=(select dep_id <span class="keyword">from</span> emp where name=<span class="string">&#x27;jason&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2-连表操作"><a href="#2-连表操作" class="headerlink" title="2.连表操作"></a>2.连表操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>inner join	 内连接	拼接公共的部分</span><br><span class="line">	select * <span class="keyword">from</span> emp inner join dep on emp.dep_id=dep.<span class="built_in">id</span>;</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>left join	 左连接 以左表为基准展示所有数据 没有的null填充</span><br><span class="line">	select * <span class="keyword">from</span> emp left join dep on emp.dep_id=dep.<span class="built_in">id</span>;</span><br><span class="line">    </span><br><span class="line"><span class="number">3.</span>right join	右连接 以右表为基准展示所有数据 没有的null填充</span><br><span class="line">	select * <span class="keyword">from</span> emp right join dep on emp.dep_id=dep.<span class="built_in">id</span>;</span><br><span class="line">    </span><br><span class="line"><span class="number">4.</span>union	 全连接</span><br><span class="line">	select * <span class="keyword">from</span> emp left join dep on emp.dep_id=dep.<span class="built_in">id</span></span><br><span class="line">    union</span><br><span class="line">    select * <span class="keyword">from</span> emp right join dep on emp.dep_id=dep.<span class="built_in">id</span>;</span><br></pre></td></tr></table></figure>

<h4 id="3-Navicat可视化软件"><a href="#3-Navicat可视化软件" class="headerlink" title="3.Navicat可视化软件"></a>3.Navicat可视化软件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>Navicat	</span><br><span class="line">    可以充当很多数据库软件的客户端 封装了很多快捷方法</span><br><span class="line">	下载链接:https://pan.baidu.com/s/1bpo5mqj</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>使用方法</span><br><span class="line">    <span class="number">1.</span>创建库 表 记录</span><br><span class="line">    <span class="number">2.</span>外键</span><br><span class="line">    <span class="number">3.</span>逆向数据库到模型</span><br><span class="line">    <span class="number">4.</span>转储SQL文件</span><br><span class="line">    <span class="number">5.</span>新建查询</span><br><span class="line">        SQL语句的注释</span><br><span class="line">            <span class="number">1.</span>-- 注释</span><br><span class="line">            <span class="number">2.</span><span class="comment"># 注释</span></span><br><span class="line">            </span><br><span class="line">注:其内部其实走的还是SQL语句</span><br></pre></td></tr></table></figure>

<h4 id="4-表字段操作补充"><a href="#4-表字段操作补充" class="headerlink" title="4.表字段操作补充"></a>4.表字段操作补充</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>添加表字段</span><br><span class="line">    alter table 表名 add 字段名 字段类型 约束条件;  <span class="comment"># 默认尾部追加</span></span><br><span class="line">    alter table 表名 add 字段名 字段类型 约束条件 after 已经存在的字段名; </span><br><span class="line">    alter table 表名 add 字段名 字段类型 约束条件 first;  <span class="comment"># 了解 </span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>修改字段</span><br><span class="line">    modify只能改字段数据类型完整约束，不能改字段名，但是change可以！</span><br><span class="line">        alter table 表名 modify 字段名 数据类型 [完整性约束条件…];</span><br><span class="line">        alter table 表名 change 旧字段名 新字段名 数据类型 [完整性约束条件…];</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>删除字段</span><br><span class="line">	alter table 表名 drop 字段名;</span><br></pre></td></tr></table></figure>

<h3 id="七-python操作MySQL"><a href="#七-python操作MySQL" class="headerlink" title="七.python操作MySQL"></a>七.python操作MySQL</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>下载模块</span><br><span class="line">	pip3 install pymysql</span><br><span class="line">	python默认下载模块的地址是国外的网站速度有时候会非常的慢 如果想要提升速度我们可以切换下载源</span><br><span class="line">    </span><br><span class="line">    <span class="number">1.</span>命令行切换源</span><br><span class="line">		pip3 install pymysql -i 源地址</span><br><span class="line">	<span class="number">2.</span>pycharm永久切换</span><br><span class="line">		file</span><br><span class="line">    		setting</span><br><span class="line">        		interpreter</span><br><span class="line">            		双击</span><br><span class="line">                		manage 仓库</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>国内下载源:</span><br><span class="line">    （<span class="number">1</span>）阿里云 http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">    （<span class="number">2</span>）豆瓣http://pypi.douban.com/simple/</span><br><span class="line">    （<span class="number">3</span>）清华大学 https://pypi.tuna.tsinghua.edu.cn/simple/</span><br><span class="line">    （<span class="number">4</span>）中国科学技术大学 http://pypi.mirrors.ustc.edu.cn/simple/</span><br><span class="line">    （<span class="number">5</span>）华中科技大学http://pypi.hustunique.com/</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="number">3.</span>基本使用</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建链接对象</span></span><br><span class="line">conn = pymysql.connect(</span><br><span class="line">    host=<span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port=<span class="number">3306</span>,</span><br><span class="line">    user=<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password=<span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    database=<span class="string">&#x27;db4_3&#x27;</span>,</span><br><span class="line">    charset=<span class="string">&#x27;utf8&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 生成游标对象</span></span><br><span class="line">cursor = conn.cursor(cursor=pymysql.cursors.DictCursor) <span class="comment"># 括号内无参默认元组,组织结构不明确</span></span><br><span class="line"><span class="comment"># 定义SQL语句</span></span><br><span class="line"><span class="comment"># sql = &#x27;show tables&#x27;</span></span><br><span class="line">sql = <span class="string">&#x27;select * from teacher&#x27;</span></span><br><span class="line"><span class="comment"># 执行sql语句</span></span><br><span class="line">affect_rows = cursor.execute(sql)</span><br><span class="line"><span class="built_in">print</span>(affect_rows)  <span class="comment"># 执行SQL语句所影响的行数</span></span><br><span class="line"><span class="comment"># 获取结果</span></span><br><span class="line">res = cursor.fetchall()</span><br><span class="line"><span class="built_in">print</span>(res) <span class="comment"># 打印执行结果</span></span><br></pre></td></tr></table></figure>

<h5 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>利用特殊符号的组合绕过相应的机制</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>如何解决</span><br><span class="line">	不要自己手动处理敏感数据</span><br><span class="line"> </span><br><span class="line">    sql = <span class="string">&quot;select * from userinfo where name=%s and password=%s&quot;</span></span><br><span class="line">    cursor.execute(sql,(username,password))  <span class="comment"># 交由execute自动拼接 自动筛选</span></span><br></pre></td></tr></table></figure>

<h5 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>针对增删改查</span><br><span class="line">	查重要程度很低 无序二次确认</span><br><span class="line">    增改删重要程度很高 都需要二次确认</span><br><span class="line"> conn = pymysql.connect(</span><br><span class="line">    host=<span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port=<span class="number">3306</span>,</span><br><span class="line">    user=<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password=<span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    database=<span class="string">&#x27;db5&#x27;</span>,</span><br><span class="line">    charset=<span class="string">&#x27;utf8&#x27;</span>,</span><br><span class="line">    autocommit=<span class="literal">True</span>  <span class="comment"># 自动二次确认</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="八-其他相关"><a href="#八-其他相关" class="headerlink" title="八.其他相关"></a>八.其他相关</h3><h4 id="1-视图"><a href="#1-视图" class="headerlink" title="1.视图"></a>1.视图</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>什么是视图?</span><br><span class="line">	视图就是通过查询得到一张虚拟表，然后保存下来，下次直接使用即可</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>为什么要用视图?</span><br><span class="line">	如果要频繁使用一张虚拟表，可以不用重复查询</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>如何使用视图?</span><br><span class="line">	create view teacher2course <span class="keyword">as</span></span><br><span class="line">    select * <span class="keyword">from</span> teacher inner join course on teacher.tid = course.teacher_id;</span><br><span class="line">    </span><br><span class="line">    创建好了之后 验证它的存在navicat验证 cmd终端验证</span><br><span class="line">    最后文件验证 得出下面的结论 视图只有表结构数据还是来源于之前的表</span><br><span class="line">    delete <span class="keyword">from</span> teacher2course where <span class="built_in">id</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h5 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、在硬盘中，视图只有表结构文件，没有表数据文件</span><br><span class="line"><span class="number">2</span>、视图通常是用于查询，尽量不要修改视图中的数据</span><br><span class="line"></span><br><span class="line">	删除视图: drop view teacher2course;</span><br></pre></td></tr></table></figure>

<h4 id="2-触发器"><a href="#2-触发器" class="headerlink" title="2.触发器"></a>2.触发器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>什么是触发器?</span><br><span class="line">	在满足对某张表数据的增、删、改的情况下，自动触发的功能称之为触发器</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>为什么要用触发器?</span><br><span class="line">	触发器专门针对我们对某一张表数据增insert、删delete、改update的行为，这类行为一旦执行</span><br><span class="line">	就会触发触发器的执行，即自动运行另外一段sql代码</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>创建触发器语法</span><br><span class="line"><span class="string">&quot;&quot;&quot;语法结构</span></span><br><span class="line"><span class="string">create trigger 触发器的名字 before/after insert/update/delete on 表名 for each row</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">	sql语句</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1.</span>针对插入</span><br><span class="line">    create trigger tri_after_insert_t1 after insert on 表名 <span class="keyword">for</span> each row</span><br><span class="line">    begin</span><br><span class="line">        sql代码。。。</span><br><span class="line">    end </span><br><span class="line">    create trigger tri_after_insert_t2 before insert on 表名 <span class="keyword">for</span> each row</span><br><span class="line">    begin</span><br><span class="line">        sql代码。。。</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    <span class="number">2.</span>针对删除</span><br><span class="line">    create trigger tri_after_delete_t1 after delete on 表名 <span class="keyword">for</span> each row</span><br><span class="line">    begin</span><br><span class="line">        sql代码。。。</span><br><span class="line">    end</span><br><span class="line">    create trigger tri_after_delete_t2 before delete on 表名 <span class="keyword">for</span> each row</span><br><span class="line">    begin</span><br><span class="line">        sql代码。。。</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    <span class="number">3.</span>针对修改</span><br><span class="line">    create trigger tri_after_update_t1 after update on 表名 <span class="keyword">for</span> each row</span><br><span class="line">    begin</span><br><span class="line">        sql代码。。。</span><br><span class="line">    end</span><br><span class="line">    create trigger tri_after_update_t2 before update on 表名 <span class="keyword">for</span> each row</span><br><span class="line">    begin</span><br><span class="line">        sql代码。。。</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">需要注意 在书写sql代码的时候结束符是; 而整个触发器的结束也需要分号;</span></span><br><span class="line"><span class="string">这就会出现语法冲突 需要我们临时修改结束符号</span></span><br><span class="line"><span class="string">delimiter $$</span></span><br><span class="line"><span class="string">delimiter ; </span></span><br><span class="line"><span class="string">该语法只在当前窗口有效  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 案例</span></span><br><span class="line">CREATE TABLE cmd (</span><br><span class="line">    <span class="built_in">id</span> INT PRIMARY KEY auto_increment,</span><br><span class="line">    USER CHAR (<span class="number">32</span>),</span><br><span class="line">    priv CHAR (<span class="number">10</span>),</span><br><span class="line">    cmd CHAR (<span class="number">64</span>),</span><br><span class="line">    sub_time datetime, <span class="comment">#提交时间</span></span><br><span class="line">    success enum (<span class="string">&#x27;yes&#x27;</span>, <span class="string">&#x27;no&#x27;</span>) <span class="comment">#0代表执行失败</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE errlog (</span><br><span class="line">    <span class="built_in">id</span> INT PRIMARY KEY auto_increment,</span><br><span class="line">    err_cmd CHAR (<span class="number">64</span>),</span><br><span class="line">    err_time datetime</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">delimiter $$  <span class="comment"># 将mysql默认的结束符由;换成$$</span></span><br><span class="line">create trigger tri_after_insert_cmd after insert on cmd <span class="keyword">for</span> each row</span><br><span class="line">begin</span><br><span class="line">    <span class="keyword">if</span> NEW.success = <span class="string">&#x27;no&#x27;</span> then  <span class="comment"># 新记录都会被MySQL封装成NEW对象</span></span><br><span class="line">        insert into errlog(err_cmd,err_time) values(NEW.cmd,NEW.sub_time);</span><br><span class="line">    end <span class="keyword">if</span>;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;  <span class="comment"># 结束之后记得再改回来，不然后面结束符就都是$$了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#往表cmd中插入记录，触发触发器，根据IF的条件决定是否插入错误日志</span></span><br><span class="line">INSERT INTO cmd (</span><br><span class="line">    USER,</span><br><span class="line">    priv,</span><br><span class="line">    cmd,</span><br><span class="line">    sub_time,</span><br><span class="line">    success</span><br><span class="line">)</span><br><span class="line">VALUES</span><br><span class="line">    (<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;0755&#x27;</span>,<span class="string">&#x27;ls -l /etc&#x27;</span>,NOW(),<span class="string">&#x27;yes&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;0755&#x27;</span>,<span class="string">&#x27;cat /etc/passwd&#x27;</span>,NOW(),<span class="string">&#x27;no&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;0755&#x27;</span>,<span class="string">&#x27;useradd xxx&#x27;</span>,NOW(),<span class="string">&#x27;no&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;0755&#x27;</span>,<span class="string">&#x27;ps aux&#x27;</span>,NOW(),<span class="string">&#x27;yes&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询errlog表记录</span></span><br><span class="line">select * <span class="keyword">from</span> errlog;</span><br><span class="line"><span class="comment"># 删除触发器</span></span><br><span class="line">drop trigger tri_after_insert_cmd;</span><br></pre></td></tr></table></figure>

<h4 id="3-事务"><a href="#3-事务" class="headerlink" title="3.事务"></a>3.事务</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>什么是事务?</span><br><span class="line">	开启一个事务可以包含一些sql语句，这些sql语句要么同时成功要么一个都别想成功，称之为事务的原子性</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>事务的作用</span><br><span class="line">	保证了对数据操作的数据安全性</span><br><span class="line">	案例:用交行的卡操作建行ATM机给工商的账户转钱</span><br><span class="line">       </span><br><span class="line"><span class="number">3.</span>事务应该具有四个属性:原子性、一致性、隔离性、持久性。这四个属性通常称为ACID特性</span><br><span class="line">    原子性（atomicity）:一个事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。</span><br><span class="line"></span><br><span class="line">	一致性（consistency）:事务必须是使数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密	  切相关的。</span><br><span class="line"></span><br><span class="line">	隔离性（isolation）:一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并			发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</span><br><span class="line"></span><br><span class="line">	持久性（durability）:持久性也称永久性（permanence），指一个事务一旦提交，它对数据库中数据的改	 变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>如何使用事务?</span><br><span class="line">	先介绍事务的三个关键字 再去用表实际展示效果</span><br><span class="line"></span><br><span class="line">    create table user(</span><br><span class="line">    <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">    name char(<span class="number">32</span>),</span><br><span class="line">    balance <span class="built_in">int</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    insert into user(name,balance)</span><br><span class="line">    values</span><br><span class="line">    (<span class="string">&#x27;jason&#x27;</span>,<span class="number">1000</span>),</span><br><span class="line">    (<span class="string">&#x27;egon&#x27;</span>,<span class="number">1000</span>),</span><br><span class="line">    (<span class="string">&#x27;tank&#x27;</span>,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 修改数据之前先开启事务操作</span></span><br><span class="line">    start transaction;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 修改操作</span></span><br><span class="line">    update user <span class="built_in">set</span> balance=<span class="number">900</span> where name=<span class="string">&#x27;jason&#x27;</span>; <span class="comment">#买支付100元</span></span><br><span class="line">    update user <span class="built_in">set</span> balance=<span class="number">1010</span> where name=<span class="string">&#x27;egon&#x27;</span>; <span class="comment">#中介拿走10元</span></span><br><span class="line">    update user <span class="built_in">set</span> balance=<span class="number">1090</span> where name=<span class="string">&#x27;tank&#x27;</span>; <span class="comment">#卖家拿到90元</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 回滚到上一个状态</span></span><br><span class="line">    rollback;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 开启事务之后，只要没有执行commit操作，数据其实都没有真正刷新到硬盘</span></span><br><span class="line">    commit;</span><br><span class="line">    <span class="string">&quot;&quot;&quot;开启事务检测操作是否完整，不完整主动回滚到上一个状态，如果完整就应该执行commit操作&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 站在python代码的角度，应该实现的伪代码逻辑，</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        update user <span class="built_in">set</span> balance=<span class="number">900</span> where name=<span class="string">&#x27;jason&#x27;</span>; <span class="comment">#买支付100元</span></span><br><span class="line">        update user <span class="built_in">set</span> balance=<span class="number">1010</span> where name=<span class="string">&#x27;egon&#x27;</span>; <span class="comment">#中介拿走10元</span></span><br><span class="line">        update user <span class="built_in">set</span> balance=<span class="number">1090</span> where name=<span class="string">&#x27;tank&#x27;</span>; <span class="comment">#卖家拿到90元</span></span><br><span class="line">    <span class="keyword">except</span> 异常:</span><br><span class="line">        rollback;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        commit;</span><br></pre></td></tr></table></figure>

<h4 id="4-存储过程"><a href="#4-存储过程" class="headerlink" title="4.存储过程"></a>4.存储过程</h4><p>存储过程包含了一系列可执行的sql语句，存储过程存放于MySQL中，通过调用它的名字可以执行其内部的一堆sql,类似于python中的自定义函数</p>
<h5 id="1-基本使用"><a href="#1-基本使用" class="headerlink" title="1.基本使用"></a>1.基本使用</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br><span class="line">create procedure p1()</span><br><span class="line">begin</span><br><span class="line">	select * <span class="keyword">from</span> user;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用</span></span><br><span class="line">call p1()</span><br></pre></td></tr></table></figure>

<h5 id="2-三种开发模型"><a href="#2-三种开发模型" class="headerlink" title="2.三种开发模型"></a>2.三种开发模型</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>第一种:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	应用程序：只需要开发应用程序的逻辑</span></span><br><span class="line"><span class="string">	mysql:编写好存储过程，以供应用程序调用</span></span><br><span class="line"><span class="string">	优点：开发效率，执行效率都高</span></span><br><span class="line"><span class="string">	缺点：考虑到人为因素、跨部门沟通等问题，会导致扩展性差</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>第二种:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	应用程序：除了开发应用程序的逻辑，还需要编写原生sql</span></span><br><span class="line"><span class="string">	优点：比方式1，扩展性高(非技术性的)</span></span><br><span class="line"><span class="string">	缺点：</span></span><br><span class="line"><span class="string">		1、开发效率，执行效率都不如方式1</span></span><br><span class="line"><span class="string">		2、编写原生sql太过于复杂，而且需要考虑到sql语句的优化问题</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line"><span class="number">3.</span>第三种:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	应用程序：开发应用程序的逻辑，不需要编写原生sql，基于别人编写好的框架来处理数据，ORM</span></span><br><span class="line"><span class="string">	优点：不用再编写纯生sql，这意味着开发效率比方式2高，同时兼容方式2扩展性高的好处</span></span><br><span class="line"><span class="string">	缺点：执行效率连方式2都比不过</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-创建存储过程"><a href="#3-创建存储过程" class="headerlink" title="3.创建存储过程"></a>3.创建存储过程</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 介绍形参特点  再写具体功能</span></span><br><span class="line"></span><br><span class="line">delimiter $$</span><br><span class="line">create procedure p2(</span><br><span class="line">    <span class="keyword">in</span> m <span class="built_in">int</span>,  <span class="comment"># in表示这个参数必须只能是传入不能被返回出去</span></span><br><span class="line">    <span class="keyword">in</span> n <span class="built_in">int</span>,  </span><br><span class="line">    out res <span class="built_in">int</span>  <span class="comment"># out表示这个参数可以被返回出去</span></span><br><span class="line">)</span><br><span class="line">begin</span><br><span class="line">    select tname <span class="keyword">from</span> teacher where tid &gt; m <span class="keyword">and</span> tid &lt; n;</span><br><span class="line">    <span class="built_in">set</span> res=<span class="number">0</span>;  <span class="comment"># 用来标志存储过程是否执行</span></span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 针对res需要先提前定义</span></span><br><span class="line"><span class="built_in">set</span> @res=<span class="number">10</span>;  定义</span><br><span class="line">select @res;  查看</span><br><span class="line">call p1(<span class="number">1</span>,<span class="number">5</span>,@res)  调用</span><br><span class="line">select @res  查看</span><br></pre></td></tr></table></figure>

<h5 id="4-如何使用存储过程"><a href="#4-如何使用存储过程" class="headerlink" title="4.如何使用存储过程"></a>4.如何使用存储过程</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 大前提:存储过程在哪个库下面创建的只能在对应的库下面才能使用！！！</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1、直接在mysql中调用</span></span><br><span class="line"><span class="built_in">set</span> @res=<span class="number">10</span>  <span class="comment"># res的值是用来判断存储过程是否被执行成功的依据，所以需要先定义一个变量@res存储10</span></span><br><span class="line">call p1(<span class="number">2</span>,<span class="number">4</span>,<span class="number">10</span>);  <span class="comment"># 报错</span></span><br><span class="line">call p1(<span class="number">2</span>,<span class="number">4</span>,@res);  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看结果</span></span><br><span class="line">select @res;  <span class="comment"># 执行成功，@res变量值发生了变化</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、在python程序中调用</span></span><br><span class="line">pymysql链接mysql</span><br><span class="line">产生的游表cursor.callproc(<span class="string">&#x27;p1&#x27;</span>,(<span class="number">2</span>,<span class="number">4</span>,<span class="number">10</span>))  <span class="comment"># 内部原理：@_p1_0=2,@_p1_1=4,@_p1_2=10;</span></span><br><span class="line">cursor.excute(<span class="string">&#x27;select @_p1_2;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、存储过程与事务使用举例(了解)</span></span><br><span class="line">delimiter //</span><br><span class="line">create PROCEDURE p5(</span><br><span class="line">    OUT p_return_code tinyint</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">    DECLARE exit handler <span class="keyword">for</span> sqlexception</span><br><span class="line">    BEGIN</span><br><span class="line">        -- ERROR</span><br><span class="line">        <span class="built_in">set</span> p_return_code = <span class="number">1</span>;</span><br><span class="line">        rollback;</span><br><span class="line">    END;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  DECLARE exit handler <span class="keyword">for</span> sqlwarning</span><br><span class="line">  BEGIN</span><br><span class="line">      -- WARNING</span><br><span class="line">      <span class="built_in">set</span> p_return_code = <span class="number">2</span>;</span><br><span class="line">      rollback;</span><br><span class="line">  END;</span><br><span class="line"></span><br><span class="line">  START TRANSACTION;</span><br><span class="line">      update user <span class="built_in">set</span> balance=<span class="number">900</span> where <span class="built_in">id</span> =<span class="number">1</span>;</span><br><span class="line">      update user123 <span class="built_in">set</span> balance=<span class="number">1010</span> where <span class="built_in">id</span> = <span class="number">2</span>;</span><br><span class="line">      update user <span class="built_in">set</span> balance=<span class="number">1090</span> where <span class="built_in">id</span> =<span class="number">3</span>;</span><br><span class="line">  COMMIT;</span><br><span class="line"></span><br><span class="line">  -- SUCCESS</span><br><span class="line">  <span class="built_in">set</span> p_return_code = <span class="number">0</span>; <span class="comment">#0代表执行成功</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">END //</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<h4 id="5-函数"><a href="#5-函数" class="headerlink" title="5.函数"></a>5.函数</h4><p>​    注意与存储过程的区别，mysql内置的函数只能在sql语句中使用！</p>
<p>​    参考博客：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/linhaifeng/articles/7495918.html#_label2">http://www.cnblogs.com/linhaifeng/articles/7495918.html#_label2</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE blog (</span><br><span class="line">    <span class="built_in">id</span> INT PRIMARY KEY auto_increment,</span><br><span class="line">    NAME CHAR (<span class="number">32</span>),</span><br><span class="line">    sub_time datetime</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO blog (NAME, sub_time)</span><br><span class="line">VALUES</span><br><span class="line">    (<span class="string">&#x27;第1篇&#x27;</span>,<span class="string">&#x27;2015-03-01 11:31:21&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第2篇&#x27;</span>,<span class="string">&#x27;2015-03-11 16:31:21&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第3篇&#x27;</span>,<span class="string">&#x27;2016-07-01 10:21:31&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第4篇&#x27;</span>,<span class="string">&#x27;2016-07-22 09:23:21&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第5篇&#x27;</span>,<span class="string">&#x27;2016-07-23 10:11:11&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第6篇&#x27;</span>,<span class="string">&#x27;2016-07-25 11:21:31&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第7篇&#x27;</span>,<span class="string">&#x27;2017-03-01 15:33:21&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第8篇&#x27;</span>,<span class="string">&#x27;2017-03-01 17:32:21&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;第9篇&#x27;</span>,<span class="string">&#x27;2017-03-01 18:31:21&#x27;</span>);</span><br><span class="line"></span><br><span class="line">select date_format(sub_time,<span class="string">&#x27;%Y-%m&#x27;</span>),count(<span class="built_in">id</span>) <span class="keyword">from</span> blog group by date_format(sub_time,<span class="string">&#x27;%Y-%m&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="6-流程控制"><a href="#6-流程控制" class="headerlink" title="6.流程控制"></a>6.流程控制</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># if条件语句</span></span><br><span class="line">delimiter //</span><br><span class="line">CREATE PROCEDURE proc_if ()</span><br><span class="line">BEGIN</span><br><span class="line">    </span><br><span class="line">    declare i <span class="built_in">int</span> default <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> i = <span class="number">1</span> THEN</span><br><span class="line">        SELECT <span class="number">1</span>;</span><br><span class="line">    ELSEIF i = <span class="number">2</span> THEN</span><br><span class="line">        SELECT <span class="number">2</span>;</span><br><span class="line">    ELSE</span><br><span class="line">        SELECT <span class="number">7</span>;</span><br><span class="line">    END IF;</span><br><span class="line"></span><br><span class="line">END //</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># while循环</span></span><br><span class="line">delimiter //</span><br><span class="line">CREATE PROCEDURE proc_while ()</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">    DECLARE num INT ;</span><br><span class="line">    SET num = <span class="number">0</span> ;</span><br><span class="line">    WHILE num &lt; <span class="number">10</span> DO</span><br><span class="line">        SELECT</span><br><span class="line">            num ;</span><br><span class="line">        SET num = num + <span class="number">1</span> ;</span><br><span class="line">    END WHILE ;</span><br><span class="line"></span><br><span class="line">END //</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<h4 id="7-索引"><a href="#7-索引" class="headerlink" title="7.索引"></a>7.索引</h4><p>知识回顾:数据都是存在硬盘上的，那查询数据不可避免的需要进行IO操作</p>
<p>索引就是一种数据结构，类似于书的目录。意味着以后再查数据应该先找目录再找数据，而不是用翻页的方式查询数据</p>
<p><em>索引在MySQL中也叫做“键”，是存储引擎用于快速找到记录的一种数据结构。</em></p>
<ul>
<li>primary key</li>
<li>unique key</li>
<li>index key</li>
</ul>
<p>注意foreign key不是用来加速查询用的，不在我们研究范围之内,上面三种key前两种除了有加速查询的效果之外还有额外的约束条件(primary key:非空且唯一，unique key:唯一)，而index key没有任何约束功能只会帮你加速查询</p>
<p><strong>本质都是：通过不断地缩小想要获取数据的范围来筛选出最终想要的结果，同时把随机的事件变成顺序的事件，也就是说，有了这种索引机制，我们可以总是用同一种查找方式来锁定数据。</strong></p>
<p><strong>索引的影响:</strong></p>
<ul>
<li>在表中有大量数据的前提下，创建索引速度会很慢</li>
<li>在索引创建完毕后，对表的查询性能会大幅度提升，但是写的性能会降低</li>
</ul>
<h5 id="b-树"><a href="#b-树" class="headerlink" title="b+树"></a><strong>b+树</strong></h5><p><a target="_blank" rel="noopener" href="https://images2017.cnblogs.com/blog/1036857/201709/1036857-20170912011123500-158121126.png">https://images2017.cnblogs.com/blog/1036857/201709/1036857-20170912011123500-158121126.png</a></p>
<p>只有叶子结点存放真实数据，根和树枝节点存的仅仅是虚拟数据</p>
<p>查询次数由树的层级决定，层级越低次数越少</p>
<p>一个磁盘块儿的大小是一定的，那也就意味着能存的数据量是一定的。如何保证树的层级最低呢？一个磁盘块儿存放占用空间比较小的数据项</p>
<p>思考我们应该给我们一张表里面的什么字段字段建立索引能够降低树的层级高度&gt;&gt;&gt; 主键id字段</p>
<h5 id="聚集索引-primary-key"><a href="#聚集索引-primary-key" class="headerlink" title="聚集索引(primary key)"></a><strong>聚集索引(primary key)</strong></h5><p>聚集索引其实指的就是表的主键，innodb引擎规定一张表中必须要有主键。先来回顾一下存储引擎。</p>
<p>myisam在建表的时候对应到硬盘有几个文件(三个)？</p>
<p>innodb在建表的时候对应到硬盘有几个文件(两个)？frm文件只存放表结构，不可能放索引，也就意味着innodb的索引跟数据都放在idb表数据文件中。</p>
<p>**特点:**叶子结点放的一条条完整的记录</p>
<h5 id="辅助索引-unique-index"><a href="#辅助索引-unique-index" class="headerlink" title="辅助索引(unique,index)"></a>辅助索引(unique,index)</h5><p>辅助索引:查询数据的时候不可能都是用id作为筛选条件，也可能会用name，password等字段信息，那么这个时候就无法利用到聚集索引的加速查询效果。就需要给其他字段建立索引，这些索引就叫辅助索引</p>
<p><strong>特点：</strong>叶子结点存放的是辅助索引字段对应的那条记录的主键的值(比如:按照name字段创建索引，那么叶子节点存放的是:{name对应的值:name所在的那条记录的主键值})</p>
<p>select name from user where name=’jason’;</p>
<p>上述语句叫覆盖索引:只在辅助索引的叶子节点中就已经找到了所有我们想要的数据</p>
<p>select age from user where name=’jason’;</p>
<p>上述语句叫非覆盖索引,虽然查询的时候命中了索引字段name，但是要查的是age字段，所以还需要利用主键才去查找</p>
<h5 id="测试索引"><a href="#测试索引" class="headerlink" title="测试索引"></a>测试索引</h5><p>​    准备</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1. 准备表</span></span><br><span class="line">create table s1(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">name varchar(<span class="number">20</span>),</span><br><span class="line">gender char(<span class="number">6</span>),</span><br><span class="line">email varchar(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#2. 创建存储过程，实现批量插入记录</span></span><br><span class="line">delimiter $$ <span class="comment">#声明存储过程的结束符号为$$</span></span><br><span class="line">create procedure auto_insert1()</span><br><span class="line">BEGIN</span><br><span class="line">    declare i <span class="built_in">int</span> default <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;<span class="number">3000000</span>)do</span><br><span class="line">        insert into s1 values(i,<span class="string">&#x27;jason&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,concat(<span class="string">&#x27;jason&#x27;</span>,i,<span class="string">&#x27;@oldboy&#x27;</span>));</span><br><span class="line">        <span class="built_in">set</span> i=i+<span class="number">1</span>;</span><br><span class="line">    end <span class="keyword">while</span>;</span><br><span class="line">END$$ <span class="comment">#$$结束</span></span><br><span class="line">delimiter ; <span class="comment">#重新声明分号为结束符号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3. 查看存储过程</span></span><br><span class="line">show create procedure auto_insert1\G </span><br><span class="line"></span><br><span class="line"><span class="comment">#4. 调用存储过程</span></span><br><span class="line">call auto_insert1();</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 表没有任何索引的情况下</span></span><br><span class="line">select * <span class="keyword">from</span> s1 where <span class="built_in">id</span>=<span class="number">30000</span>;</span><br><span class="line"><span class="comment"># 避免打印带来的时间损耗</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> = <span class="number">30000</span>;</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给id做一个主键</span></span><br><span class="line">alter table s1 add primary key(<span class="built_in">id</span>);  <span class="comment"># 速度很慢</span></span><br><span class="line"></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> = <span class="number">1</span>;  <span class="comment"># 速度相较于未建索引之前两者差着数量级</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name = <span class="string">&#x27;jason&#x27;</span>  <span class="comment"># 速度仍然很慢</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">范围问题</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 并不是加了索引，以后查询的时候按照这个字段速度就一定快   </span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> &gt; <span class="number">1</span>;  <span class="comment"># 速度相较于id = 1慢了很多</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> &gt;<span class="number">1</span> <span class="keyword">and</span> <span class="built_in">id</span> &lt; <span class="number">3</span>;</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> &gt; <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">id</span> &lt; <span class="number">10000</span>;</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> != <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">alter table s1 drop primary key;  <span class="comment"># 删除主键 单独再来研究name字段</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name = <span class="string">&#x27;jason&#x27;</span>;  <span class="comment"># 又慢了</span></span><br><span class="line"></span><br><span class="line">create index idx_name on s1(name);  <span class="comment"># 给s1表的name字段创建索引</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name = <span class="string">&#x27;jason&#x27;</span>  <span class="comment"># 仍然很慢！！！</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">再来看b+树的原理，数据需要区分度比较高，而我们这张表全是jason，根本无法区分</span></span><br><span class="line"><span class="string">那这个树其实就建成了“一根棍子”</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name = <span class="string">&#x27;xxx&#x27;</span>;  </span><br><span class="line"><span class="comment"># 这个会很快，我就是一根棍，第一个不匹配直接不需要再往下走了</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name like <span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name like <span class="string">&#x27;xxx%&#x27;</span>;</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name like <span class="string">&#x27;%xxx&#x27;</span>;  <span class="comment"># 慢 最左匹配特性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 区分度低的字段不能建索引</span></span><br><span class="line">drop index idx_name on s1;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给id字段建普通的索引</span></span><br><span class="line">create index idx_id on s1(<span class="built_in">id</span>);</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> = <span class="number">3</span>;  <span class="comment"># 快了</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span>*<span class="number">12</span> = <span class="number">3</span>;  <span class="comment"># 慢了  索引的字段一定不要参与计算</span></span><br><span class="line"></span><br><span class="line">drop index idx_id on s1;</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> = <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line"><span class="comment"># 针对上面这种连续多个and的操作，mysql会从左到右先找区分度比较高的索引字段，先将整体范围降下来再去比较其他条件</span></span><br><span class="line">create index idx_name on s1(name);</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> = <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;  <span class="comment"># 并没有加速</span></span><br><span class="line"></span><br><span class="line">drop index idx_name on s1;</span><br><span class="line"><span class="comment"># 给name，gender这种区分度不高的字段加上索引并不难加快查询速度</span></span><br><span class="line"></span><br><span class="line">create index idx_id on s1(<span class="built_in">id</span>);</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> = <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;  <span class="comment"># 快了  先通过id已经讲数据快速锁定成了一条了</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> &gt; <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;  <span class="comment"># 慢了  基于id查出来的数据仍然很多，然后还要去比较其他字段</span></span><br><span class="line"></span><br><span class="line">drop index idx_id on s1</span><br><span class="line"></span><br><span class="line">create index idx_email on s1(email);</span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> &gt; <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;  <span class="comment"># 快 通过email字段一剑封喉 </span></span><br></pre></td></tr></table></figure>

<h5 id="联合索引"><a href="#联合索引" class="headerlink" title="联合索引"></a>联合索引</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> &gt; <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;  </span><br><span class="line"><span class="comment"># 如果上述四个字段区分度都很高，那给谁建都能加速查询</span></span><br><span class="line"><span class="comment"># 给email加然而不用email字段</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> &gt; <span class="number">3</span>; </span><br><span class="line"><span class="comment"># 给name加然而不用name字段</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> &gt; <span class="number">3</span>; </span><br><span class="line"><span class="comment"># 给gender加然而不用gender字段</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where <span class="built_in">id</span> &gt; <span class="number">3</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 带来的问题是所有的字段都建了索引然而都没有用到，还需要花费四次建立的时间</span></span><br><span class="line">create index idx_all on s1(email,name,gender,<span class="built_in">id</span>);  <span class="comment"># 最左匹配原则，区分度高的往左放</span></span><br><span class="line">select count(<span class="built_in">id</span>) <span class="keyword">from</span> s1 where name=<span class="string">&#x27;jason&#x27;</span> <span class="keyword">and</span> gender = <span class="string">&#x27;male&#x27;</span> <span class="keyword">and</span> <span class="built_in">id</span> &gt; <span class="number">3</span> <span class="keyword">and</span> email = <span class="string">&#x27;xxx&#x27;</span>;  <span class="comment"># 速度变快</span></span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/07/20/hello-world/" rel="next" title="Hello World">
                  Hello World <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">左大大</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
