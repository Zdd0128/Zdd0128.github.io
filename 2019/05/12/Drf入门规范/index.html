<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="Drf(Djano高级)1.Web开发模式1234561 前后端混合开发	-模板渲染在后端完成    var name&#x3D;&quot;&amp;#123;&amp;#123;dic&amp;#125;&amp;#125;&quot;2 前后端分离（主流）	-后端只负责写接口，前端来调用，通信使用json格式    -多端（web，app）都可以使用同一个接口   前后端不分离: 前后端分离: 2.API接口123456789101">
<meta property="og:type" content="article">
<meta property="og:title" content="Drf入门规范">
<meta property="og:url" content="http://example.com/2019/05/12/Drf%E5%85%A5%E9%97%A8%E8%A7%84%E8%8C%83/index.html">
<meta property="og:site_name" content="左大大的博客">
<meta property="og:description" content="Drf(Djano高级)1.Web开发模式1234561 前后端混合开发	-模板渲染在后端完成    var name&#x3D;&quot;&amp;#123;&amp;#123;dic&amp;#125;&amp;#125;&quot;2 前后端分离（主流）	-后端只负责写接口，前端来调用，通信使用json格式    -多端（web，app）都可以使用同一个接口   前后端不分离: 前后端分离: 2.API接口123456789101">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628182533637.png">
<meta property="og:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628182613156.png">
<meta property="og:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628184627445.png">
<meta property="og:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628184657295.png">
<meta property="og:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628184729439.png">
<meta property="og:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628184809594.png">
<meta property="article:published_time" content="2019-05-12T10:20:25.000Z">
<meta property="article:modified_time" content="2019-05-12T10:20:25.000Z">
<meta property="article:author" content="左大大">
<meta property="article:tag" content="Python Linux Vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:/Users/左旗伟/AppData/Roaming/Typora/typora-user-images/image-20210628182533637.png">


<link rel="canonical" href="http://example.com/2019/05/12/Drf%E5%85%A5%E9%97%A8%E8%A7%84%E8%8C%83/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2019/05/12/Drf%E5%85%A5%E9%97%A8%E8%A7%84%E8%8C%83/","path":"2019/05/12/Drf入门规范/","title":"Drf入门规范"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Drf入门规范 | 左大大的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">左大大的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Drf-Djano%E9%AB%98%E7%BA%A7"><span class="nav-number">1.</span> <span class="nav-text">Drf(Djano高级)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Web%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.1.</span> <span class="nav-text">1.Web开发模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E4%B8%8D%E5%88%86%E7%A6%BB"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">前后端不分离:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">前后端分离:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-API%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.2.</span> <span class="nav-text">2.API接口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="nav-number">1.2.1.</span> <span class="nav-text">接口测试工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-RESTful%E8%A7%84%E8%8C%83"><span class="nav-number">1.3.</span> <span class="nav-text">3.RESTful规范</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">1.4.</span> <span class="nav-text">4.序列化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Drf%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%89%E8%A3%85"><span class="nav-number">1.5.</span> <span class="nav-text">5.Drf简介及安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%9F%BA%E4%BA%8EDrf%E5%BF%AB%E9%80%9F%E5%AE%9E%E7%8E%B0%E4%BA%94%E4%B8%AA%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.6.</span> <span class="nav-text">6.基于Drf快速实现五个接口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1%E8%B7%AF%E7%94%B1%E5%B1%82"><span class="nav-number">1.6.1.</span> <span class="nav-text">6.1路由层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2%E8%A7%86%E5%9B%BE%E5%B1%82"><span class="nav-number">1.6.2.</span> <span class="nav-text">6.2视图层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3%E6%A8%A1%E5%9E%8B%E5%B1%82"><span class="nav-number">1.6.3.</span> <span class="nav-text">6.3模型层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB"><span class="nav-number">1.6.4.</span> <span class="nav-text">6.4序列化类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-Cbv%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="nav-number">1.7.</span> <span class="nav-text">7.Cbv源码分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-DRF%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E5%8F%8A%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="nav-number">1.8.</span> <span class="nav-text">8.DRF基本使用及执行流程分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1%E7%BB%A7%E6%89%BFAPIView%E4%BD%BF%E7%94%A8"><span class="nav-number">1.8.1.</span> <span class="nav-text">8.1继承APIView使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2APIView%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">1.8.2.</span> <span class="nav-text">8.2APIView执行流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3APIView%E5%92%8CRequest%E5%AF%B9%E8%B1%A1%E5%88%86%E6%9E%90"><span class="nav-number">1.8.3.</span> <span class="nav-text">8.3APIView和Request对象分析</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="左大大"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">左大大</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">103</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/05/12/Drf%E5%85%A5%E9%97%A8%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="左大大">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="左大大的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Drf入门规范
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-05-12 18:20:25" itemprop="dateCreated datePublished" datetime="2019-05-12T18:20:25+08:00">2019-05-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Django%E9%AB%98%E7%BA%A7/" itemprop="url" rel="index"><span itemprop="name">Django高级</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Drf-Djano高级"><a href="#Drf-Djano高级" class="headerlink" title="Drf(Djano高级)"></a>Drf(Djano高级)</h1><h2 id="1-Web开发模式"><a href="#1-Web开发模式" class="headerlink" title="1.Web开发模式"></a>1.Web开发模式</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 前后端混合开发</span><br><span class="line">	-模板渲染在后端完成</span><br><span class="line">    var name=<span class="string">&quot;&#123;&#123;dic&#125;&#125;&quot;</span></span><br><span class="line"><span class="number">2</span> 前后端分离（主流）</span><br><span class="line">	-后端只负责写接口，前端来调用，通信使用json格式</span><br><span class="line">    -多端（web，app）都可以使用同一个接口 </span><br></pre></td></tr></table></figure>

<h4 id="前后端不分离"><a href="#前后端不分离" class="headerlink" title="前后端不分离:"></a>前后端不分离:</h4><p><img src="C:\Users\左旗伟\AppData\Roaming\Typora\typora-user-images\image-20210628182533637.png" alt="image-20210628182533637"></p>
<h4 id="前后端分离"><a href="#前后端分离" class="headerlink" title="前后端分离:"></a>前后端分离:</h4><p><img src="C:\Users\左旗伟\AppData\Roaming\Typora\typora-user-images\image-20210628182613156.png" alt="image-20210628182613156"></p>
<h2 id="2-API接口"><a href="#2-API接口" class="headerlink" title="2.API接口"></a>2.API接口</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>什么是API接口(应用程序接口)?</span><br><span class="line">    通过网络，规定了前后台信息交互规则的url链接，也就是前后台信息交互的媒介</span><br><span class="line">	为了在团队内部形成共识、防止个人习惯差异引起的混乱，我们需要找到一种大家都觉得很好的接口实现规范，而且这种规范能够让后端写的接口，用途一目了然，减少双方之间的合作成本(详细可以查看微博开放平台:https://<span class="built_in">open</span>.weibo.com/wiki/<span class="number">2</span>/users/show)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>API功能</span><br><span class="line">	<span class="number">1.</span>API确认所有操作都是合法的</span><br><span class="line">	<span class="number">2.</span>在发生错误时，API会根据错误报告机制发出指示</span><br><span class="line">	<span class="number">3.</span>API内置授权和访问控制，确保只有授权人员才能访问特殊数据</span><br><span class="line">	<span class="number">4.</span>可以充当防火墙，防止资源被滥用，允许合法的请求</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>常见API接口形式</span><br><span class="line">	<span class="number">1.</span>HTTP类型接口</span><br><span class="line">		基于HTTP协议提供的API,这类API常常以“网址”形式提供的,像现在主流的RESTful就属于这类接口</span><br><span class="line">        </span><br><span class="line">	<span class="number">2.</span>RPC接口</span><br><span class="line">		RPC它是指远程过程调用，将一部分代码逻辑放在远程服务器上部署，然后在需要的地方调用即可(调用远程方法就像调用本地方法一样),本质上是Client/Server模式，而且支持多种协议和数据传输方式</span><br><span class="line">        </span><br><span class="line">	<span class="number">3.</span>Web Service 接口</span><br><span class="line">		Web Service并不具象地指某种API，我们将以WEB形式提供的服务都称之为Web Service，像RESTful也属于Web Service。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="number">4.</span>API接口四大特点:</span><br><span class="line">    <span class="number">1.</span>url：长得像返回数据的url链接</span><br><span class="line">    <span class="number">2.</span>请求方式：get、post、put、patch、delete</span><br><span class="line">    <span class="number">3.</span>请求参数：json或xml格式的&#123;key:value&#125;类型数据</span><br><span class="line">    <span class="number">4.</span>响应结果：json或xml格式的数据</span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line"><span class="number">5.</span>接口约束子类行为</span><br><span class="line">	-人为</span><br><span class="line">    -abc模块</span><br><span class="line">    -父类抛异常</span><br></pre></td></tr></table></figure>

<h3 id="接口测试工具"><a href="#接口测试工具" class="headerlink" title="接口测试工具"></a>接口测试工具</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 接口测试工具:</span></span><br><span class="line">	<span class="number">1.</span>接口测试工具有很多 --&gt; postman,浏览器插件，接口压力测试工具Jmeter</span><br><span class="line">    <span class="number">2.</span>本质就是模拟发送http请求</span><br><span class="line">    <span class="number">3.</span>安装postman ---&gt; 双击即可</span><br><span class="line">    <span class="number">4.</span>前后端交互的编码方式</span><br><span class="line">    	-urlencoded		<span class="comment"># 普通数据</span></span><br><span class="line">        -form-data		<span class="comment"># 普通数据和文件数据</span></span><br><span class="line">        -json			<span class="comment"># json格式数据</span></span><br><span class="line">    <span class="number">5.</span>详见http://www.liuqingzheng.top/python/Django-rest-framework%E6%A1%<span class="number">86</span>%E6%9E%B6/<span class="number">1</span>-drf-drf%E5%<span class="number">85</span>%A5%E9%<span class="number">97</span>%A8%E8%A7%<span class="number">84</span>%E8%8C%<span class="number">83</span>/</span><br></pre></td></tr></table></figure>

<p><strong>工作面板:</strong></p>
<p><img src="C:\Users\左旗伟\AppData\Roaming\Typora\typora-user-images\image-20210628184627445.png" alt="image-20210628184627445"></p>
<p><strong>简易get请求:</strong></p>
<p><img src="C:\Users\左旗伟\AppData\Roaming\Typora\typora-user-images\image-20210628184657295.png" alt="image-20210628184657295"></p>
<p><strong>简易的post请求:</strong></p>
<p><img src="C:\Users\左旗伟\AppData\Roaming\Typora\typora-user-images\image-20210628184729439.png" alt="image-20210628184729439"></p>
<p><strong>案例:请求百度地图接口</strong></p>
<p><img src="C:\Users\左旗伟\AppData\Roaming\Typora\typora-user-images\image-20210628184809594.png" alt="image-20210628184809594"></p>
<h2 id="3-RESTful规范"><a href="#3-RESTful规范" class="headerlink" title="3.RESTful规范"></a>3.RESTful规范</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>什么是RESTful?</span><br><span class="line">	RESTful是一种定义Web API接口的设计风格，尤其适用于前后端分离的应用模式中,大部分的接口，都会按照这个规范去写(Web API接口的设计风格)最早出现在<span class="number">2000</span>年Roy Fielding的博士论文中</span><br><span class="line">	</span><br><span class="line"><span class="number">2.</span>RESTful十条:</span><br><span class="line">	<span class="number">1.</span>url链接一般都采用https协议进行传输(提高数据交互过程中的安全性)</span><br><span class="line">    </span><br><span class="line">	<span class="number">2.</span>url中带关键字api(代表该请求url链接是完成前后台数据交互的)</span><br><span class="line">        eg:</span><br><span class="line">            https://api.baidu.com</span><br><span class="line">            https://www.baidu.com/api</span><br><span class="line">                </span><br><span class="line">	<span class="number">3.</span>url中带版本信息</span><br><span class="line">        eg:</span><br><span class="line">            https://api.baidu.com/v1</span><br><span class="line">            https://api.baidu.com/v2</span><br><span class="line">                </span><br><span class="line">    <span class="number">4.</span>数据即资源，均使用名词表示(可复数)</span><br><span class="line">        eg:</span><br><span class="line">            https://api.baidu.com/users</span><br><span class="line">            https://api.baidu.com/books</span><br><span class="line">            https://api.baidu.com/book</span><br><span class="line">                </span><br><span class="line">    <span class="number">5</span> 资源操作由请求方式决定</span><br><span class="line">        -查询操作----get(查单条,查所有)</span><br><span class="line">        -新增操作----post</span><br><span class="line">        -修改操作----put(整体修改),patch(局部修改)</span><br><span class="line">        -删除操作----delete</span><br><span class="line">        eg:</span><br><span class="line">            https://api.baidu.com/books 	- get请求：获取所有书</span><br><span class="line">            https://api.baidu.com/books/<span class="number">1</span> 	- get请求：获取主键为<span class="number">1</span>的书</span><br><span class="line">            https://api.baidu.com/books 	- post请求：新增一本书书</span><br><span class="line">            https://api.baidu.com/books/<span class="number">1</span>	- put请求：整体修改主键为<span class="number">1</span>的书</span><br><span class="line">            https://api.baidu.com/books/<span class="number">1</span> 	- patch请求：局部修改主键为<span class="number">1</span>的书</span><br><span class="line">            https://api.baidu.com/books/<span class="number">1</span> 	- delete请求：删除主键为<span class="number">1</span>的书</span><br><span class="line">                </span><br><span class="line">     <span class="number">6</span> 请求url中带搜索筛选条件(通过在url上传参的形式传递搜索条件)</span><br><span class="line">    	https://api.example.com/v1/zoos?limit=<span class="number">10</span>：			<span class="comment"># 指定返回记录的数量</span></span><br><span class="line">        https://api.example.com/v1/zoos?offset=<span class="number">10</span>：			<span class="comment"># 指定返回记录的开始位置</span></span><br><span class="line">        https://api.example.com/v1/zoos?animal_type_id=<span class="number">1</span>：	<span class="comment"># 指定筛选条件</span></span><br><span class="line">            </span><br><span class="line">   	 <span class="number">7.</span>响应中要带状态码（自己定义，http响应状态码）</span><br><span class="line">        &#123;</span><br><span class="line">        	status:<span class="number">200</span></span><br><span class="line">        &#125;</span><br><span class="line">        eg:(常见状态码)</span><br><span class="line">            <span class="number">200</span>：常规请求</span><br><span class="line">			<span class="number">201</span>：创建成功</span><br><span class="line">            <span class="number">301</span>：永久重定向</span><br><span class="line">            <span class="number">302</span>：暂时重定向</span><br><span class="line">            <span class="number">403</span>：请求无权限</span><br><span class="line">            <span class="number">404</span>：请求路径或资源不存在</span><br><span class="line">            <span class="number">405</span>：请求方法不存在</span><br><span class="line">            <span class="number">500</span>：服务器异常</span><br><span class="line"> </span><br><span class="line">      <span class="number">8.</span>响应返回错误或提示信息</span><br><span class="line">         &#123;</span><br><span class="line">             status:<span class="number">200</span></span><br><span class="line">             msg: <span class="string">&quot;无权限操作&quot;</span></span><br><span class="line">         &#125;</span><br><span class="line">        </span><br><span class="line">      <span class="number">9.</span>返回结果，遵循如下规范(大概率都没有遵循)</span><br><span class="line">        GET /collection				<span class="comment"># 返回资源对象的列表（数组）</span></span><br><span class="line">        GET /collection/resource	<span class="comment"># 返回单个资源对象</span></span><br><span class="line">        POST /collection			<span class="comment"># 返回新生成的资源对象</span></span><br><span class="line">        PUT /collection/resource	<span class="comment"># 返回完整的资源对象</span></span><br><span class="line">        PATCH /collection/resource	<span class="comment"># 返回完整的资源对象</span></span><br><span class="line">        DELETE /collection/resource	<span class="comment"># 返回一个空文档</span></span><br><span class="line">      </span><br><span class="line">      <span class="number">10.</span>返回数据中带链接地址</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="string">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">        <span class="string">&quot;results&quot;</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>:<span class="string">&quot;肯德基(罗餐厅)&quot;</span>,</span><br><span class="line">                <span class="string">&quot;img&quot;</span>: <span class="string">&quot;https://image.baidu.com/kfc/001.png&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        	]</span><br><span class="line">    	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-序列化"><a href="#4-序列化" class="headerlink" title="4.序列化"></a>4.序列化</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 什么是序列化和反序列化?</span></span><br><span class="line">	序列化：把我们识别的数据转换成指定的格式提供给别人</span><br><span class="line">	反序列化：把别人提供的数据转换/还原成我们需要的格式</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line">    前端js提供过来的json数据,对于python而言就是字符串，我们需要进行反序列化换成模型类对象，这样我们才能把数据保存到数据库中</span><br></pre></td></tr></table></figure>

<h2 id="5-Drf简介及安装"><a href="#5-Drf简介及安装" class="headerlink" title="5.Drf简介及安装"></a>5.Drf简介及安装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Drf简介:</span></span><br><span class="line">	Django Rest_Framework:是django的一个app，可以借助它快速在django框架开发出符合restful规范的接口</span><br><span class="line"><span class="comment"># Drf提供了：</span></span><br><span class="line">	REST framework还提供了认证、权限、限流、过滤、分页、接口文档等功能支持</span><br><span class="line"><span class="comment"># Drf官方文档：</span></span><br><span class="line">	https://www.django-rest-framework.org/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># python django的版本支持情况</span></span><br><span class="line">    Python（<span class="number">3.5</span>、<span class="number">3.6</span>、<span class="number">3.7</span>、<span class="number">3.8</span>、<span class="number">3.9</span>）</span><br><span class="line">    Django (<span class="number">2.2</span>, <span class="number">3.0</span>, <span class="number">3.1</span>)   <span class="number">2.</span>x用的多，<span class="number">1.</span>x老项目</span><br><span class="line"></span><br><span class="line"><span class="comment"># django版本区别：1版本跟2b没有大的区别</span></span><br><span class="line">	<span class="number">1</span>版本支持路由正则匹配,<span class="number">2</span>版本的路由写什么就是什么,精准匹配,<span class="number">5</span>个转换器(<span class="built_in">int</span>，<span class="built_in">str</span>，slug，path，uuid)</span><br><span class="line">    <span class="number">1</span>版本默认级联更新级联删除,<span class="number">2</span>版本需要自己指定级联删除动作</span><br><span class="line">      </span><br><span class="line"><span class="comment">#安装</span></span><br><span class="line">	pip3 install djangorestframework</span><br><span class="line">    <span class="comment"># 注意：跟django版本对应好，django 2.2.2 ---&gt; drf最新</span></span><br></pre></td></tr></table></figure>

<h2 id="6-基于Drf快速实现五个接口"><a href="#6-基于Drf快速实现五个接口" class="headerlink" title="6.基于Drf快速实现五个接口"></a>6.基于Drf快速实现五个接口</h2><h3 id="6-1路由层"><a href="#6-1路由层" class="headerlink" title="6.1路由层"></a>6.1路由层</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> SimpleRouter</span><br><span class="line"><span class="keyword">from</span> app01 <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">router = SimpleRouter()</span><br><span class="line">router.register(<span class="string">&#x27;book&#x27;</span>, views.BookView)</span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment">#    path(&#x27;admin/&#x27;, admin.site.urls),</span></span><br><span class="line">]</span><br><span class="line">urlpatterns += router.urls</span><br></pre></td></tr></table></figure>

<h3 id="6-2视图层"><a href="#6-2视图层" class="headerlink" title="6.2视图层"></a>6.2视图层</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"><span class="keyword">from</span> .serizlizer <span class="keyword">import</span> BookSerializer</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Books</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookView</span>(<span class="params">ModelViewSet</span>):</span></span><br><span class="line">    queryset = Books.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = BookSerializer</span><br></pre></td></tr></table></figure>

<h3 id="6-3模型层"><a href="#6-3模型层" class="headerlink" title="6.3模型层"></a>6.3模型层</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Books</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    name=models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    price=models.IntegerField()</span><br><span class="line">    publish=models.CharField(max_length=<span class="number">32</span>)</span><br></pre></td></tr></table></figure>

<h3 id="6-4序列化类"><a href="#6-4序列化类" class="headerlink" title="6.4序列化类"></a>6.4序列化类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.serializers <span class="keyword">import</span> ModelSerializer</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Books</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookSerializer</span>(<span class="params">ModelSerializer</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model=Books</span><br><span class="line">        fields=<span class="string">&#x27;__all__&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="7-Cbv源码分析"><a href="#7-Cbv源码分析" class="headerlink" title="7.Cbv源码分析"></a>7.Cbv源码分析</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>views.Book.as_view()执行完的结果一定是个函数内存地址</span><br><span class="line"><span class="number">2.</span>as_view是View类的类方法，类来调用</span><br><span class="line"><span class="number">3.</span>as_view中view这个闭包函数的源码是</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">view</span>(<span class="params">request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="comment"># 核心代码</span></span><br><span class="line">        <span class="keyword">return</span> self.dispatch(request, *args, **kwargs)</span><br><span class="line">        </span><br><span class="line"><span class="number">4.</span>执行了View类的dispatch</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dispatch</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="comment"># 如果是get请求</span></span><br><span class="line">        <span class="comment"># request.method.lower() 是get字符串，下面条件符合</span></span><br><span class="line">        <span class="keyword">if</span> request.method.lower() <span class="keyword">in</span> self.http_method_names:</span><br><span class="line">            <span class="comment"># 通过反射拿到我们写的Book视图类的中的get方法</span></span><br><span class="line">            handler = <span class="built_in">getattr</span>(self, request.method.lower(), self.http_method_not_allowed)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            handler = self.http_method_not_allowed</span><br><span class="line">        <span class="comment"># get(request, *args, **kwargs)----&gt;执行Book视图类中的get方法,再同FBV</span></span><br><span class="line">        <span class="keyword">return</span> handler(request, *args, **kwargs)</span><br><span class="line">    </span><br><span class="line"><span class="number">5.</span>扩展，如果我在Book视图类中重写dispatch方法</span><br><span class="line">	-可以实现，在get，post方法执行之前或者之后执行代码，完成类似装饰器的效果</span><br><span class="line">       <span class="function"><span class="keyword">def</span> <span class="title">dispatch</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">            <span class="comment"># 加代码</span></span><br><span class="line">            response=<span class="built_in">super</span>().dispatch(request, *args, **kwargs)</span><br><span class="line">            <span class="comment"># 加代码</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>

<h2 id="8-DRF基本使用及执行流程分析"><a href="#8-DRF基本使用及执行流程分析" class="headerlink" title="8.DRF基本使用及执行流程分析"></a>8.DRF基本使用及执行流程分析</h2><h3 id="8-1继承APIView使用"><a href="#8-1继承APIView使用" class="headerlink" title="8.1继承APIView使用"></a>8.1继承APIView使用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">from</span> rest_framework.request <span class="keyword">import</span> Request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookAPIView</span>(<span class="params">APIView</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="comment"># 这个request是什么？新的，drf的Reqeust对象,用起来，跟老request对象一样</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">type</span>(request))  		  <span class="comment"># rest_framework.request.Request</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">type</span>(request._request)) <span class="comment"># django.core.handlers.wsgi.WSGIRequest</span></span><br><span class="line">        <span class="built_in">print</span>(request.GET)  <span class="comment"># 神奇</span></span><br><span class="line">        <span class="built_in">print</span>(request._request.GET)  <span class="comment"># 应该这么用</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(request.data)</span><br><span class="line">        <span class="keyword">return</span> Response(<span class="string">&#x27;get请求&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="comment"># 以后再取值，都从request.data中取(三种编码格式数据都可以取到)</span></span><br><span class="line">        <span class="built_in">print</span>(request.data)</span><br><span class="line">        <span class="built_in">print</span>(request.POST)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(<span class="string">&#x27;post请求&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="8-2APIView执行流程"><a href="#8-2APIView执行流程" class="headerlink" title="8.2APIView执行流程"></a>8.2APIView执行流程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># APIView继承了django的View</span></span><br><span class="line"><span class="number">1.</span>APIView中重写了as_view</span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">as_view</span>(<span class="params">cls, **initkwargs</span>):</span></span><br><span class="line">        <span class="comment"># 调用父类的as_view</span></span><br><span class="line">        view = <span class="built_in">super</span>().as_view(**initkwargs)</span><br><span class="line">        <span class="comment"># 只要继承APIView以后所有的视图都没有csrf保护了 不管是否注释掉中间件 </span></span><br><span class="line">        <span class="keyword">return</span> csrf_exempt(view)</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>请求来了-&gt;路由匹配上-&gt;view(request)-&gt;调用self.dispatch-&gt;apiview中重写了diapatch</span><br><span class="line">执行self.dispatch()----&gt;APIView的dispatch</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dispatch</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">		<span class="comment"># 重新包装了一个新的request对象，基于原来的request对象包装的</span></span><br><span class="line">        <span class="comment"># 这个request对象是新的request对象，是drf提供的Request类的对象</span></span><br><span class="line">        <span class="comment"># 新的request包含原来老的request(django的request)</span></span><br><span class="line">        <span class="comment"># self._request = request</span></span><br><span class="line">        request = self.initialize_request(request, *args, **kwargs)</span><br><span class="line">        <span class="comment">#print(request._request)  老的request对象</span></span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">        	<span class="comment"># 认证，权限，频率...</span></span><br><span class="line">            self.initial(request, *args, **kwargs)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> request.method.lower() <span class="keyword">in</span> self.http_method_names:</span><br><span class="line">                handler = <span class="built_in">getattr</span>(self, request.method.lower(),</span><br><span class="line">                                  self.http_method_not_allowed)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                handler = self.http_method_not_allowed</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># 视图类中get方法的执行</span></span><br><span class="line">            response = handler(request, *args, **kwargs)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> exc:</span><br><span class="line">            <span class="comment"># 如果在视图类中有错误，会被捕获（全局异常处理）</span></span><br><span class="line">            response = self.handle_exception(exc)</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 把response包装了一下，返回</span></span><br><span class="line">        self.response = self.finalize_response(request, response, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> self.response</span><br><span class="line">	   </span><br><span class="line"><span class="number">3.</span>在视图类中使用的request对象是新的request对象，老的是request._request</span><br><span class="line">	-新的request.GET拿到的还是老的GET，原理如下(Request类重写了__getattr__)</span><br><span class="line">       <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, attr</span>):</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># 通过反射 获取原生的request对象,取其属性或方法</span></span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">getattr</span>(self._request, attr)</span><br><span class="line">            <span class="keyword">except</span> AttributeError:</span><br><span class="line">                <span class="keyword">return</span> self.__getattribute__(attr)</span><br><span class="line">            </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">魔法方法：</span></span><br><span class="line"><span class="string">	类中__名字__的方法，就叫魔法方法,学过的__init__(类实例化执行),__str__(打印对象执行)</span></span><br><span class="line"><span class="string">    不需要主动调用,某种特定条件就会触发它的执行</span></span><br><span class="line"><span class="string">    __getattr__：对象.属性，会触发它的执行</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">            </span><br><span class="line"><span class="number">4.</span>结论:以后继承了APIView后，request对象成了新的，但是跟原来一样用</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>新的request对象中有一个属性data</span><br><span class="line">	<span class="comment"># request.data感觉是一个数据属性,其实是一个方法,被@property修饰</span></span><br><span class="line">	-data是post请求携带的数据(三种编码格式)----&gt;字典</span><br><span class="line">    -无论是什么编码格式，只要是post提交的数据，都在request.data中</span><br><span class="line">	-以后再取值，都从request.data中取</span><br></pre></td></tr></table></figure>

<h3 id="8-3APIView和Request对象分析"><a href="#8-3APIView和Request对象分析" class="headerlink" title="8.3APIView和Request对象分析"></a>8.3APIView和Request对象分析</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 以后如果使用了drf，继承APIView(drf提供了很多view，他们都是继承自APIView)执行流程如下</span><br><span class="line">	-包装出了一个新的request，在视图函数中使用时，跟原来没有区别</span><br><span class="line">    -注意：</span><br><span class="line">    取post提交的数据，不要从request.POST中取了，要从request.data中取</span><br><span class="line">    取get提交的数据，尽量不从request.GET中取了，要从request.query_params中取</span><br><span class="line">    eg:</span><br><span class="line"><span class="meta">        @property</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">query_params</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">return</span> self._request.GET</span><br><span class="line">    </span><br><span class="line"><span class="number">2</span> Request类(drf的)中需要掌握的</span><br><span class="line">	-request.data  			<span class="comment"># 方法包装成了数据属性</span></span><br><span class="line">    -request.query_params 	<span class="comment"># 就是request._request.GET</span></span><br><span class="line">    -request.FIELS        	<span class="comment"># 上传的文件</span></span><br><span class="line">    -用起来跟原来一样</span><br><span class="line">    </span><br><span class="line"><span class="number">3</span> APIView类</span><br><span class="line">	-包装新的request</span><br><span class="line">    -执行了认证，权限，频率....</span><br><span class="line">    -处理了全局异常</span><br><span class="line">    -包装了response对象</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/05/04/Ajax/" rel="prev" title="Ajax">
                  <i class="fa fa-chevron-left"></i> Ajax
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/05/14/Drf%E8%B7%AF%E7%94%B1/" rel="next" title="Drf路由">
                  Drf路由 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">左大大</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
